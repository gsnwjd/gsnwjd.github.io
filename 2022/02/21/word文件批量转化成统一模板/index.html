<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="&amp;nbsp;&amp;nbsp;——本文允许转载,分享请注明网站出处: ）会做这个是因为我妈妈需要把13个不同模板的课件(网上down的课件资料)转成统一模板的13个课件，并且放在一个.docx文件里，我觉得这种繁琐的事情可以用代码来完成(一开始会想的特别简单)，我找了很多资料也对比了不同的插件功能，最后写了一些不太完美的脚本，也算减轻了一些我妈的工作量，本文中会提到html和docx互相转化的插件，主要">
<meta property="og:type" content="article">
<meta property="og:title" content="word文件批量转化成统一模板">
<meta property="og:url" content="https://gsnwjd.github.io/2022/02/21/word文件批量转化成统一模板/index.html">
<meta property="og:site_name" content="关四鸟">
<meta property="og:description" content="&amp;nbsp;&amp;nbsp;——本文允许转载,分享请注明网站出处: ）会做这个是因为我妈妈需要把13个不同模板的课件(网上down的课件资料)转成统一模板的13个课件，并且放在一个.docx文件里，我觉得这种繁琐的事情可以用代码来完成(一开始会想的特别简单)，我找了很多资料也对比了不同的插件功能，最后写了一些不太完美的脚本，也算减轻了一些我妈的工作量，本文中会提到html和docx互相转化的插件，主要">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://gsnwjd.github.io/2022/02/21/word文件批量转化成统一模板/res.jpg">
<meta property="og:image" content="https://gsnwjd.github.io/2022/02/21/word文件批量转化成统一模板/res2.png">
<meta property="og:updated_time" content="2022-02-21T09:39:35.340Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="word文件批量转化成统一模板">
<meta name="twitter:description" content="&amp;nbsp;&amp;nbsp;——本文允许转载,分享请注明网站出处: ）会做这个是因为我妈妈需要把13个不同模板的课件(网上down的课件资料)转成统一模板的13个课件，并且放在一个.docx文件里，我觉得这种繁琐的事情可以用代码来完成(一开始会想的特别简单)，我找了很多资料也对比了不同的插件功能，最后写了一些不太完美的脚本，也算减轻了一些我妈的工作量，本文中会提到html和docx互相转化的插件，主要">
<meta name="twitter:image" content="https://gsnwjd.github.io/2022/02/21/word文件批量转化成统一模板/res.jpg">





  
  
  <link rel="canonical" href="https://gsnwjd.github.io/2022/02/21/word文件批量转化成统一模板/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>word文件批量转化成统一模板 | 关四鸟</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">关四鸟</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">——王佳典的漫漫coding之旅</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gsnwjd.github.io/2022/02/21/word文件批量转化成统一模板/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="gsnwjd王佳典">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关四鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">word文件批量转化成统一模板

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2022-02-21 15:26:46 / 修改时间：09:39:35" itemprop="dateCreated datePublished" datetime="2022-02-21T15:26:46Z">2022-02-21</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><span style="color:#8c8c8c;border-left:4px solid #246ca0;">&nbsp;&nbsp;——本文允许转载,分享请注明网站出处: ）</span><br><br>会做这个是因为我妈妈需要把13个不同模板的课件(网上down的课件资料)转成统一模板的13个课件，并且放在一个.docx文件里，我觉得这种繁琐的事情可以用代码来完成(一开始会想的特别简单)，我找了很多资料也对比了不同的插件功能，最后写了一些不太完美的脚本，也算减轻了一些我妈的工作量，本文中会提到html和docx互相转化的插件，主要是<span style="color:#246ca0;font-weight:bold;font-size:14px;">mammoth,htmlDocx</span>，还有一些文件操作的模块  <span style="color:#2491a0;font-weight:bold;font-size:14px;">fs,adm-zip,file-saver</span><br><img src="/2022/02/21/word文件批量转化成统一模板/res.jpg" alt="res"><br>具体步骤就是<br><span style="font-weight:bold;color:#3d7388;font-size:14px;">拿到右图docx的模板(html格式)-&gt;获取源docx的内容，放入一个有指定内容块名称的对象中-&gt;内容循环填充到模板里，导出docx</span></p><p style="color:#2ea6d6;font-weight:bold;font-size:15px;">拿模板<span style="color:#8e8dd1;font-style:italic;font-weight: bolder;">&nbsp;&nbsp;fs,mammoth</span></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var mammoth = require(&quot;mammoth&quot;);</span><br><span class="line">import fs from &apos;fs&apos;</span><br><span class="line"></span><br><span class="line">mammoth.convertToHtml(&#123;path: &quot;./static/word/testword.docx&quot;&#125;)</span><br><span class="line">    .then(function(result)&#123;</span><br><span class="line">      var html = result.value; </span><br><span class="line">      var messages = result.messages; // Any messages, such as warnings during conversion</span><br><span class="line">      fs.writeFile(&apos;./static/word/testword.html&apos;, html, res =&gt; &#123;</span><br><span class="line">          console.log(&apos;文件写入成功&apos;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;).done();</span><br></pre></td></tr></table></figure>这样可以得到一个模板table，但是这个table再通过html转化成docx的时候，样式却会不同，所以需要调整这个table的样式，写在标签的style里，用字符串模板写一个模板<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">let content = `&lt;table width=&quot;100%&quot; border=&quot;1&quot; style=&quot;font-size:14px;line-height:17px;&quot; cellspacing=&quot;1&quot;&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;td width=&quot;14%&quot;&gt;课题&lt;/td&gt;</span><br><span class="line">    &lt;td width=&quot;86%&quot; colspan=&quot;4&quot;&gt;$&#123;title&#125;&lt;br/&gt;&lt;/td&gt;</span><br><span class="line">  &lt;/tr&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;主备人&lt;br/&gt;&lt;/td&gt;</span><br><span class="line">    &lt;td&gt;此处写名字&lt;br/&gt;&lt;/td&gt;</span><br><span class="line">    &lt;td width=&quot;15%&quot; colspan=&quot;2&quot;&gt;授课时间&lt;/td&gt;</span><br><span class="line">    &lt;td width=&quot;20%&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/td&gt;</span><br><span class="line">  &lt;/tr&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;教学目标&lt;/td&gt;</span><br><span class="line">    &lt;td colspan=&quot;4&quot;&gt;</span><br><span class="line">      $&#123;target&#125;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line">  &lt;/tr&gt;</span><br><span class="line">  &lt;tr&gt;&lt;td&gt;重点&lt;/td&gt;</span><br><span class="line">      &lt;td colspan=&quot;4&quot;&gt;$&#123;important&#125;&lt;/td&gt;</span><br><span class="line">  &lt;tr&gt;&lt;td&gt;难点&lt;/td&gt;</span><br><span class="line">      &lt;td colspan=&quot;4&quot;&gt;$&#123;hard&#125;&lt;/td&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;td width=&quot;78%&quot; colspan=&quot;3&quot;&gt;教学过程&lt;/td&gt;</span><br><span class="line">    &lt;td width=&quot;22%&quot; colspan=&quot;2&quot;&gt;设计意图、方法、策略&lt;/td&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;td colspan=&quot;3&quot;&gt;$&#123;duration&#125;&lt;/td&gt;</span><br><span class="line">    &lt;td colspan=&quot;2&quot;&gt;$&#123;design&#125;&lt;/td&gt;</span><br><span class="line">  &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;教学反思&lt;/td&gt;</span><br><span class="line">    &lt;td colspan=&quot;4&quot;&gt;</span><br><span class="line">      $&#123;this.recoverIdea(num_id,important)&#125;&lt;/td&gt;</span><br><span class="line">  &lt;/table&gt;`</span><br></pre></td></tr></table></figure><p style="color:#2ea6d6;font-weight:bold;font-size:15px;">从docx中获取文本内容<span style="color:#8e8dd1;font-style:italic;font-weight: bolder;">&nbsp;&nbsp;fs,adm-zip,正则</span></p>.docx其实是一个压缩包，压缩包里的/word/document.xml里的内容才是我们需要的。下面直接贴代码，包括了读取文件夹下所有.docx文件，重命名为.zip，然后读取xml，再通过正则获取内容<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">//  /server/interface/utils/template.js</span><br><span class="line"></span><br><span class="line">import fs from &apos;fs&apos;</span><br><span class="line">const AdmZip = require(&apos;adm-zip&apos;); //引入查看zip文件的包</span><br><span class="line"></span><br><span class="line">const wordTool = &#123;</span><br><span class="line">    togetContent:new Function(),</span><br><span class="line">    cutDoc:new Function(),</span><br><span class="line">    fileName:[]</span><br><span class="line">&#125;</span><br><span class="line">wordTool.togetContent = function()&#123;</span><br><span class="line">    return new Promise((resolve,reject)=&gt;&#123;</span><br><span class="line">        fs.readdir(&apos;./static/word/real&apos;,(err,data)=&gt;&#123;</span><br><span class="line">            if(err)&#123;</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                var fileNames = Object.assign([],data.filter((item)=&gt;&#123;</span><br><span class="line">                    return item.split(&apos;&apos;)[0]!==&apos;~&apos;</span><br><span class="line">                &#125;))</span><br><span class="line">                fileNames.forEach(item=&gt;&#123;</span><br><span class="line">                    fs.rename(&apos;./static/word/real/&apos;+item,&apos;./static/word/real/&apos;+item.replace(&apos;.docx&apos;,&apos;.zip&apos;),(err,data)=&gt;&#123;</span><br><span class="line">                        //</span><br><span class="line">                    &#125;)</span><br><span class="line">                    return item.replace(&apos;.docx&apos;,&apos;.zip&apos;);</span><br><span class="line">                &#125;)</span><br><span class="line">                var objs = fileNames.map((item)=&gt;&#123;</span><br><span class="line">                    const zip = new AdmZip(`./static/word/real/$&#123;item&#125;`); //filePath为文件路径</span><br><span class="line">                    let contentXml = zip.readAsText(&quot;word/document.xml&quot;);//将document.xml读取为text内容；</span><br><span class="line">                    let str = &quot;&quot;;</span><br><span class="line">                    contentXml.match(/(&lt;w:t&gt;|&lt;w:t xml:space=&quot;preserve&quot;&gt;|&lt;w:instrText xml:space=&quot;preserve&quot;&gt;)[\s\S]*?(&lt;\/w:t&gt;|&lt;\/w:instrText&gt;)/ig).forEach((item)=&gt;&#123;</span><br><span class="line">                        str += item.split(&apos;&gt;&apos;)[1].split(&apos;&lt;&apos;)[0].replace(/&amp;gt;/g,&apos;&gt;&apos;).replace(&apos;&amp;lt;&apos;,&apos;&lt;&apos;).trim().replace(&apos;INCLUDEPICTURE&quot;&apos;,&apos;&apos;).replace(&apos;.TIF&quot;&apos;,&apos;&apos;)</span><br><span class="line">                    &#125;)</span><br><span class="line">                    var obj = wordTool.cutDoc(str,item)</span><br><span class="line">                    return obj</span><br><span class="line">                &#125;)</span><br><span class="line">                resolve(objs)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wordTool.cutDoc = function(str,name)&#123;</span><br><span class="line">    var obj = &#123;</span><br><span class="line">        title:&apos;&apos;,</span><br><span class="line">        target:&apos;&apos;,</span><br><span class="line">        important:&apos;&apos;,</span><br><span class="line">        hard:&apos;&apos;,</span><br><span class="line">        duration:&apos;&apos;,</span><br><span class="line">        tools:&apos;&apos;,</span><br><span class="line">        teaches:&apos;&apos;,</span><br><span class="line">        work:&apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    var teaches = [&apos;讲授法&apos;,&apos;任务驱动法&apos;]</span><br><span class="line">    var tools = [&apos;讨论法&apos;,&apos;练习法&apos;]</span><br><span class="line">    if(str.indexOf(&apos;【教学目标】&apos;)!==-1)&#123;</span><br><span class="line">        var i1 = str.indexOf(&apos;【教学目标】&apos;)</span><br><span class="line">        var i2 = str.indexOf(&apos;【教学重点与难点】&apos;)</span><br><span class="line">        var i3 = str.indexOf(&apos;【教学过程】&apos;)</span><br><span class="line">        var i4 = str.indexOf(&apos;巩固新知&apos;)</span><br><span class="line">        var i5 = str.indexOf(&apos;四、&apos;)</span><br><span class="line">        obj.title = str.slice(0,i1).split(&apos; &apos;)[1]</span><br><span class="line">        obj.target = str.slice(i1+6,i2)</span><br><span class="line">        var hards = str.slice(i2+9,i3)</span><br><span class="line">        var a=0,b=1;</span><br><span class="line">        if(hards.indexOf(&apos;重点&apos;)&gt;6)&#123;</span><br><span class="line">            a=1</span><br><span class="line">            b=0</span><br><span class="line">        &#125;</span><br><span class="line">        hards = hards.replace(&apos;重点：&apos;,&apos;&apos;).replace(&apos;难点：&apos;,&apos;&apos;)</span><br><span class="line">        obj.important = hards.split(&apos;。&apos;)[a]+&apos;。&apos;</span><br><span class="line">        obj.hard = hards.split(&apos;。&apos;)[b]+&apos;。&apos;</span><br><span class="line">        </span><br><span class="line">        obj.duration = str.slice(i3+6,i4-2)</span><br><span class="line">        obj.work=str.slice(i4,i5).replace(&apos;巩固新知&apos;,&apos;&apos;)</span><br><span class="line">        obj.teaches = teaches.join(&apos;,&apos;)</span><br><span class="line">        obj.tools = tools.join(&apos;,&apos;)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        str = str.replace(/TIF/g,&apos;&apos;).replace(/INCLUDEPICTURE/g,&apos;&apos;).replace(/\.&quot;/g,&apos;&apos;)</span><br><span class="line">        var i0 = str.indexOf(&apos;学习目标&apos;)</span><br><span class="line">        var i1 = str.indexOf(&apos;教学过程&apos;)</span><br><span class="line">        var iend = str.indexOf(&apos;教学反思&apos;)</span><br><span class="line">        var tar = name.split(&apos; &apos;)</span><br><span class="line">        obj.title = tar[tar.length-2]+&apos; &apos;+tar[tar.length-1].replace(&apos;.zip&apos;,&apos;&apos;)</span><br><span class="line"></span><br><span class="line">        var tar2 = str.slice(i0+4,i1).replace(&apos;(重点、难点)&apos;,&apos;&apos;).replace(&apos;(重点)&apos;,&apos;&apos;).replace(&apos;(难点)&apos;,&apos;&apos;).replace(&apos;学习目标&apos;,&apos;&apos;)</span><br><span class="line">        obj.target = tar2</span><br><span class="line">        obj.hard = tar2.split(&apos;；&apos;)[tar2.split(&apos;.&apos;).length-1]</span><br><span class="line">        obj.important = tar2.split(&apos;；&apos;)[tar2.split(&apos;.&apos;).length-2]</span><br><span class="line">        obj.duration = str.slice(i1,iend).replace(&apos;教学过程&apos;,&apos;&apos;)</span><br><span class="line">        obj.teaches = teaches[0]</span><br><span class="line">        obj.tools = tools[1]</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default wordTool</span><br></pre></td></tr></table></figure>我们在一个server文件里导入写好的工具，返回所有处理好的数据到前端，此处后端用的是koa<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// /server/interface/arti.js</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">import wordTool from &apos;./utils/template&apos;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">router.get(&apos;/test&apos;,async(ctx)=&gt;&#123;</span><br><span class="line">  try&#123;</span><br><span class="line">    let content = []</span><br><span class="line">    await wordTool.togetContent().then((res)=&gt;&#123;</span><br><span class="line">        content = res</span><br><span class="line">    &#125;)</span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">        code:0,</span><br><span class="line">        msg:content,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;catch(e)&#123;</span><br><span class="line">      console.log(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#2ea6d6;font-weight:bold;font-size:15px;">批量转化<span style="color:#8e8dd1;font-style:italic;font-weight: bolder;">&nbsp;&nbsp;htmlDocx,saveAs</span></p>测试用例word.vue编写如下，此处用到第一步我们写出的table模板<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      测试word转换&lt;br/&gt;</span><br><span class="line">      &lt;el-button @click=&quot;exportClick()&quot; type=&quot;primary&quot;&gt;测试&lt;/el-button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import htmlDocx from &apos;html-docx-js/dist/html-docx&apos;;</span><br><span class="line">import saveAs from &apos;file-saver&apos;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            msg:[]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed:&#123;</span><br><span class="line">      dataObj()&#123;</span><br><span class="line">        return this.msg</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        exportClick() &#123;</span><br><span class="line">          var tables = this.dataObj.map((item,idx)=&gt;&#123;</span><br><span class="line">            return this.initContents(item,idx)</span><br><span class="line">          &#125;)</span><br><span class="line">          var str_Table = tables.join(&apos;&lt;br/&gt;&apos;)</span><br><span class="line">          var page = `&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;UTF-8&quot;&gt;&lt;/head&gt;&lt;body&gt;$&#123;str_Table&#125;&lt;/body&gt;&lt;/html&gt;`</span><br><span class="line">          var converted = htmlDocx.asBlob(page);</span><br><span class="line">          var name = Math.random().toString().slice(2,9)</span><br><span class="line">          saveAs(converted, name+&apos;.docx&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        initContents(obj,idx)&#123;</span><br><span class="line">          let num_id = idx+1;</span><br><span class="line">          let &#123;title,target,important,hard,duration,tools,teaches,work&#125; = obj</span><br><span class="line">          let design = this.designX(title,important)</span><br><span class="line">          let content = `&lt;table width=&quot;100%&quot; border=&quot;1&quot; style=&quot;font-size:14px;line-height:17px;&quot; cellspacing=&quot;1&quot;&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;14%&quot;&gt;课题&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;86%&quot; colspan=&quot;4&quot;&gt;$&#123;title&#125;&lt;br/&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;主备人&lt;br/&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td&gt;此处写名字&lt;br/&gt;&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;15%&quot; colspan=&quot;2&quot;&gt;授课时间&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;20%&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;教学目标&lt;/td&gt;</span><br><span class="line">              &lt;td colspan=&quot;4&quot;&gt;</span><br><span class="line">                $&#123;target&#125;</span><br><span class="line">              &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr&gt;&lt;td&gt;重点&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&quot;4&quot;&gt;$&#123;important&#125;&lt;/td&gt;</span><br><span class="line">            &lt;tr&gt;&lt;td&gt;难点&lt;/td&gt;</span><br><span class="line">                &lt;td colspan=&quot;4&quot;&gt;$&#123;hard&#125;&lt;/td&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td width=&quot;78%&quot; colspan=&quot;3&quot;&gt;教学过程&lt;/td&gt;</span><br><span class="line">              &lt;td width=&quot;22%&quot; colspan=&quot;2&quot;&gt;设计意图、方法、策略&lt;/td&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td colspan=&quot;3&quot;&gt;$&#123;duration&#125;&lt;/td&gt;</span><br><span class="line">              &lt;td colspan=&quot;2&quot;&gt;$&#123;design&#125;&lt;/td&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">              &lt;td&gt;教学反思&lt;/td&gt;</span><br><span class="line">              &lt;td colspan=&quot;4&quot;&gt;</span><br><span class="line">                $&#123;this.recoverIdea(num_id,important)&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/table&gt;`</span><br><span class="line">          return content</span><br><span class="line">        &#125;,</span><br><span class="line">        designX(name,important)&#123;</span><br><span class="line">          let arr = [</span><br><span class="line">            `情境导入引入本节重点．`,</span><br><span class="line">            `本环节由例题讲授，轻松自然的引出$&#123;name.split(&apos; &apos;)[name.split(&apos; &apos;).length-1]&#125;的关键概念，而且培养了学生以发展的眼光看数学，逐步建构自己知识体系的能力。`,</span><br><span class="line">            `讲述了$&#123;important&#125;等本节核心`</span><br><span class="line">          ]</span><br><span class="line">          return arr.map(item=&gt;&#123;return `$&#123;item&#125;`&#125;).join(&apos;&lt;br/&gt;&lt;br/&gt;&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        recoverIdea(num_id,important)&#123;</span><br><span class="line">          let arr = [</span><br><span class="line">            `$&#123;important&#125;单从纯数学的角度去让学生领会，显然是比较枯燥、乏味的。我从学生的经验和已有的知识出发，激发学生的学习兴趣，向学生提供充分从事数学活动的机会，增强学生学好数学的信心。使这些枯燥的知识变成鲜活、灵动数学，让学生在解决问题的过程中既学到了知识，又体念到了学数学的快乐。`,</span><br><span class="line">            `本节课通过对学生身边熟悉的事物引入，让学生感受到生活中处处有数学，数学与我们的生活密不可分；学生经历合作探究过程获得新知，并能用所学的新知识来解决实际问题．这样教学更能激发学生学习数学的兴趣，提升学生的能力，促进学生的发展。`,</span><br><span class="line">            `在解决具体情境的问题中初步感知$&#123;important&#125;然后思考例题并交流讨论，学生的抽象、概括、推理能力都得到一定的提高。`</span><br><span class="line">          ]</span><br><span class="line">          let id = (Math.random().toString().slice(2,3))%3</span><br><span class="line">          return arr[id]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    async asyncData(ctx) &#123;</span><br><span class="line">    let self = this</span><br><span class="line">    let &#123;status,data:&#123;msg&#125;&#125; = await ctx.$axios.get(&quot;/arti/test&quot;);</span><br><span class="line">    if(status === 200)&#123;</span><br><span class="line">      // console.log(table)</span><br><span class="line">        return &#123;msg&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><br>最后能够得到统一模板的word<br><img src="/2022/02/21/word文件批量转化成统一模板/res2.png" alt="res"><br><p style="color:#2ea6d6;font-weight:bold;font-size:15px;">必须提到的两个问题<span style="color:#8e8dd1;font-style:italic;font-weight: bolder;">&nbsp;&nbsp;数学符号，图片</span></p>.docx里的数学符号在转换成html的时候会乱码，比如2/3（.docx里分式是上下排列的，这里写2/3是举个例子）会变成eq \f(2,3)，这个我目前还没找到解决办法。<br><br>用<span style="color:#3d7388;font-weight:bold;font-size:15px;">mammoth</span>转换.docx得到.html的时候，图片会直接转换成base64格式，这样就比用正则在xml里找图片id映射到.docx的zip文件夹里的图片要简单得多，但是因为最后转换成的课件要求一课保持在一页之内(如果模板写得再精细一点也是可以做到关键标题处换行，并计算有没有超出页面范围)，所以我没有做图片相关的转换。<p></p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/12/27/一小时聊完Less/" rel="next" title="一小时聊完Less">
                <i class="fa fa-chevron-left"></i> 一小时聊完Less
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">gsnwjd王佳典</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">gsnwjd王佳典</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.1"></script>



  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
