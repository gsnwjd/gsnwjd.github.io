<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="关四鸟">
<meta property="og:url" content="https://gsnwjd.github.io/index.html">
<meta property="og:site_name" content="关四鸟">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="关四鸟">





  
  
  <link rel="canonical" href="https://gsnwjd.github.io/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>关四鸟</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">关四鸟</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">——王佳典的漫漫coding之旅</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gsnwjd.github.io/2020/08/23/6-7-8工作总结（say-goodbye-to-dunxi）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="gsnwjd王佳典">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关四鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/08/23/6-7-8工作总结（say-goodbye-to-dunxi）/" class="post-title-link" itemprop="url">6-7-8工作总结（say-goodbye-to-dunxi）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-08-23 08:35:20 / 修改时间：00:44:39" itemprop="dateCreated datePublished" datetime="2020-08-23T08:35:20Z">2020-08-23</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="color:#8c8c8c;border-left:4px solid #759477;">&nbsp;&nbsp;——本文禁止转载,分享请注明网站出处: ）</span><br></p>
<p>6月14号的时候来到上海，6月25号入职敦汐，到8月17号正式离职，离职的原因并不想多说。再回头看码云，所有的commit都变成了一个个的绿格子。</p>
<p><img src="/2020/08/23/6-7-8工作总结（say-goodbye-to-dunxi）/my.png" alt="码云个人主页">离职以后，我想着要写一篇工作总结。<br><br>一开始入职的时候，我们是在做一个纺织公司的后台管理系统，后来又在做体育培训管理解决方案。都是基于Jeecg-boot这个框架，Jeecg-boot又是基于Antd和SpringBoot，其中我主要负责打印功能的实现，例如合同和送货单的打印，还有一些其他功能的实现，但是并不是所有细枝末节都值得被记录，以下会记录一些真正让我有收获的知识点。</p><p style="color:#59755e;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">打印</p><br><span style="color:rgb(191, 201, 99);font-size:15px;">“所有一切基于vue-print-nb”,v-print=打印区域的ID</span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//main.js</span><br><span class="line">    import Print from &apos;vue-print-nb-jeecg&apos;</span><br><span class="line">    Vue.use(Print)</span><br><span class="line">    </span><br><span class="line">    //***.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;Print&quot;&gt;</span><br><span class="line">    &lt;a-button type=&quot;primary&quot; @click=&quot;dataColl&quot; icon=&quot;printer&quot;&gt;打印&lt;/a-button&gt;</span><br><span class="line">    &lt;a-modal v-model=&quot;visible&quot; title=&quot;打印预览&quot; on-ok=&quot;handleOk&quot; :width=&quot;width&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;ContractPrint&quot; id=&quot;printerDemo2&quot;&gt;</span><br><span class="line">      此处放打印内容</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;template slot=&quot;footer&quot;&gt;</span><br><span class="line">        &lt;a-button key=&quot;back&quot; @click=&quot;handleCancel&quot;&gt;取消&lt;/a-button&gt;</span><br><span class="line">        &lt;a-button</span><br><span class="line">          key=&quot;submit&quot;</span><br><span class="line">          type=&quot;primary&quot;</span><br><span class="line">          :loading=&quot;loading&quot;</span><br><span class="line">          @click=&quot;handleOk&quot;</span><br><span class="line">          v-print=&quot;&apos;#printerDemo2&apos;&quot;</span><br><span class="line">        &gt;确认&lt;/a-button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/a-modal&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p></p>
<p style="color:#91a76e;font-weight:bold">去掉边角水印</p>firefox调用打印的时候会产生难看的水印，直接调用打印方法会在生成的pdf上面出现“page1”，网址。可能在页头，或者页尾,我们需要在style里加上以下代码，去掉水印。同时为了美观我们可以加上padding。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@media print &#123;</span><br><span class="line">  @page &#123;</span><br><span class="line">    size: auto;</span><br><span class="line">    margin: 0mm;</span><br><span class="line">  &#125;</span><br><span class="line">  #printerDemo2&#123;</span><br><span class="line">    padding:30px;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p style="color:#91a76e;font-weight:bold">打印出正常的A4</p>想要正好是A4纸张大小，其实只需要长:宽 约等于<span style="color:#949e72;">297/210</span>，但是建议正常打印的时候这个比例要小一点，要不然打印还是有可能跳到下一页，但是由于打印的时候很多在style里写的css会失效，最起码我在打印原生table的时候table的格子就全部挤到左边，其实在预览的时候它们都是好好的。所以要么写成内嵌style的样子，要么用flex+div，或者直接用antd所自带的栅格来写，这样最后结果pdf才可能和预览的时候一样。<br><br>顺便说一下，由于vue-printer-nb应该是进行canvas绘图之后打印canvas，所以只要比例ok，它会把所有内容塞到一张A4纸上。想要换页，只能进行设置。<p style="color:#91a76e;font-weight:bold">换页</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.break &#123;</span><br><span class="line">  page-break-before: auto;</span><br><span class="line">  page-break-after: always;</span><br><span class="line">&#125;</span><br><span class="line">.nobreak&#123;</span><br><span class="line">  page-break-after:avoid;</span><br><span class="line">&#125;</span><br><span class="line">.one_Page&#123;</span><br><span class="line">  height: 1130px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;a4_page&quot; :class=&quot;&#123;break:data_now.length&gt;120,one_Page:data_now.length&gt;120&#125;&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>实际情况比以上的代码复杂一丢丢，为了好理解简化成上面那一段。不过也可以很清楚地看到如果要分页，就绑定一个.break类。<br>其他排版什么的都需要根据实际情况调整。</p><p style="color:#59755e;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">Id to Name</p><br>由于是后台管理系统，所以基础逻辑都是对数据表的增删改查，Jeecg-boot对于基础的增删改查全部写好了，利用Antd的<span style="color:rgb(96, 156, 146);font-style:italic;font-weight: bolder;">a-table</span><br>都绑定数据名为dataSource的dataSource,在组件里引入mixin，在mixin里写方法调用接口进行增删改查和批量删除。<br>由于数据表存放了大量的Id，Id与Id之间关联，例如品牌的数据表里需要存放一个场馆Id，在页面上显示Id，只会让操作的人一头雾水，所以必须以Id存储，以name显示。<br>所以我在已经封装好的mixin里又写了封装。（其实这个应该后端来做，接口调太多是不是不太好？）<br><span style="color:rgb(60, 182, 121);font-style:italic;font-weight: bolder;">原来的mixin</span><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">loadData(arg) &#123;</span><br><span class="line">  if(!this.url.list)&#123;</span><br><span class="line">    this.$message.error(&quot;请设置url.list属性!&quot;)</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  //加载数据 若传入参数1则加载第一页的内容</span><br><span class="line">  if (arg === 1) &#123;</span><br><span class="line">    this.ipagination.current = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  var params = this.getQueryParams();//查询条件</span><br><span class="line">  this.loading = true;</span><br><span class="line">  getAction(this.url.list, params).then((res) =&gt; &#123;</span><br><span class="line">    if (res.success) &#123;</span><br><span class="line">      this.dataSource = res.result.records;</span><br><span class="line">      this.ipagination.total = res.result.total;</span><br><span class="line">    &#125;</span><br><span class="line">    if(res.code===510)&#123;</span><br><span class="line">      this.$message.warning(res.message)</span><br><span class="line">    &#125;</span><br><span class="line">    this.loading = false;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><span style="color:rgb(60, 182, 121);font-style:italic;font-weight: bolder;">修改之后的mixin</span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">loadData(arg) &#123;</span><br><span class="line">  if(!this.url.list)&#123;</span><br><span class="line">    this.$message.error(&quot;请设置url.list属性!&quot;)</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  //加载数据 若传入参数1则加载第一页的内容</span><br><span class="line">  if (arg === 1) &#123;</span><br><span class="line">    this.ipagination.current = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  var params = this.getQueryParams();//查询条件</span><br><span class="line">  this.loading = true;</span><br><span class="line">  getAction(this.url.list, params).then((res) =&gt; &#123;</span><br><span class="line">    if (res.success) &#123;</span><br><span class="line">      this.dataSource = res.result.records;</span><br><span class="line">      let obj = this.dataSource[0]</span><br><span class="line">      let boolean_arr = []</span><br><span class="line">      for(let idx in obj)&#123;</span><br><span class="line">        boolean_arr.push(idx)</span><br><span class="line">      &#125;</span><br><span class="line">      let arr_all = boolean_arr.join(&quot;.&quot;)</span><br><span class="line">      if(this.url.idToName)&#123;</span><br><span class="line">      //有就转换，没有就不转换</span><br><span class="line">        this.url.idToName.map((item)=&gt;&#123;</span><br><span class="line"></span><br><span class="line">          if(arr_all.indexOf(item.id)&gt;0)&#123;//此表是否能找到此Id</span><br><span class="line">            let pro = item.id</span><br><span class="line">            let tourl = item.tourl</span><br><span class="line">            let props = pro+&apos;_toname&apos;</span><br><span class="line">            let name = item.name</span><br><span class="line">            let str = &apos;&apos;</span><br><span class="line">            this.dataSource.map((item)=&gt;&#123;</span><br><span class="line">              let val = item[pro]</span><br><span class="line">              if(val)&#123;</span><br><span class="line">                getAction(`$&#123;tourl&#125;?id=$&#123;val&#125;`).then((res)=&gt;&#123;</span><br><span class="line">                  if(res.success)&#123;</span><br><span class="line">                    let obj = res.result.records ? res.result.records[0] : []</span><br><span class="line">                    str = obj[name]</span><br><span class="line">                  &#125;</span><br><span class="line">                  this.$set(item,`$&#123;props&#125;`,str)</span><br><span class="line">                  //此处给dataSource加列需要使用.$set方法，否则无法修改视图层</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;else&#123;</span><br><span class="line">                console.log(&apos;此格为空&apos;)</span><br><span class="line">                this.$set(item,`$&#123;props&#125;`,&apos;无&apos;)</span><br><span class="line">              &#125;</span><br><span class="line">              // console.log(item)</span><br><span class="line">              return item</span><br><span class="line">            &#125;)&#125;else&#123;</span><br><span class="line">              console.log(&apos;此表不存在此id&apos;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      // console.log(this.dataSource)</span><br><span class="line">      this.ipagination.total = res.result.total;</span><br><span class="line">    &#125;</span><br><span class="line">    if(res.code===510)&#123;</span><br><span class="line">      this.$message.warning(res.message)</span><br><span class="line">    &#125;</span><br><span class="line">    this.loading = false;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">  </span><br></pre></td></tr></table></figure>如果需要使用的话，vue页面里需要这么改<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">table绑定的columns里一个列可以直接加</span><br><span class="line">&#123;</span><br><span class="line">  title:&apos;父团队ID&apos;,</span><br><span class="line">  align:&quot;center&quot;,</span><br><span class="line">  dataIndex: &apos;storeFatherId&apos;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  title:&apos;父团队ID&apos;,</span><br><span class="line">  align:&quot;center&quot;,</span><br><span class="line">  dataIndex: &apos;storeFatherId_toname&apos;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">data里定义的url也需要</span><br><span class="line">url: &#123;</span><br><span class="line">  list: &quot;/basic/sportsStoreInfo/list&quot;,</span><br><span class="line">  delete: &quot;/basic/sportsStoreInfo/delete&quot;,</span><br><span class="line">  deleteBatch: &quot;/basic/sportsStoreInfo/deleteBatch&quot;,</span><br><span class="line">  exportXlsUrl: &quot;/basic/sportsStoreInfo/exportXls&quot;,</span><br><span class="line">  importExcelUrl: &quot;basic/sportsStoreInfo/importExcel&quot;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line"></span><br><span class="line">url: &#123;</span><br><span class="line">  list: &quot;/basic/sportsStoreInfo/list&quot;,</span><br><span class="line">  delete: &quot;/basic/sportsStoreInfo/delete&quot;,</span><br><span class="line">  deleteBatch: &quot;/basic/sportsStoreInfo/deleteBatch&quot;,</span><br><span class="line">  exportXlsUrl: &quot;/basic/sportsStoreInfo/exportXls&quot;,</span><br><span class="line">  importExcelUrl: &quot;basic/sportsStoreInfo/importExcel&quot;,</span><br><span class="line">  </span><br><span class="line">  idToName:[&#123;</span><br><span class="line">    id:&apos;storeFatherId&apos;,//A表数据Id(本张表数据Id)</span><br><span class="line">    name:&apos;teamName&apos;,//B表数据名称</span><br><span class="line">    tourl:&quot;/basic/sportsTeamInfo/list&quot;//B表数据URL</span><br><span class="line">  &#125;],</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#59755e;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">Jeecg-boot的选框(存在数据依赖)</p>其实这个解释起来会有一丢丢的复杂，具体modal如下图。<img src="/2020/08/23/6-7-8工作总结（say-goodbye-to-dunxi）/select.png" alt="码云个人主页">这里面的每一个选框需要加载出来的数据在父modal跳出的时候就已经加载完成，如果我们点击选择按钮，出现子modal,子modal加载出的数据表的数据，我们是无法去修改的。别问为什么父传子传值很简单，的确，是很简单。但是当数据如下传递<br><span style="color:rgb(89, 146, 106);font-size:15px;">SportsCardInfoModal.vue-&gt;JSelectBrand.vue/<em>此处开始传参到封装</em>/-&gt;JSelectBizComponent/index.vue-&gt;JSelectBizComponent/JSelectBizComponent.vue(此处为数据源真正显示的地方)</span>每一层都是用prop传的值，所以也就意味着父亲可以命令儿子，但是曾曾祖父没办法命令曾曾孙子。（puchi）<br>当我们选择场馆，希望通过返回的场馆的id值去过滤与此场馆id关联的品牌，当我们希望能够选择的邀约班级要根据以上场馆id，品牌id，到馆时间是星期几（大部分班级一周只上一节课，所以有星期几的筛选）进行筛选的时候，我们就很难用这个封装完全的组件去做了。毕竟它只能显示数据源-&gt;选择一条-&gt;返回id。<br>用封装太过的框架就会这样，当我们要写逻辑性比较强的功能的时候，就会陷入到底是应该重写一个轮子（这个是轮子吗？），还是用其他方法的困境，最后，我还是选择去适应这个轮子。<br><br>在app.js里的state定义一个全局的空数组为detail，写一个push的方法，写一个清空的方法(actions,mutations里都要写)<br>以下是简化的代码。<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--给页面的选框绑定方法，传值--&gt;</span><br><span class="line">   &lt;a-form-item label=&quot;邀约场馆&quot; :labelCol=&quot;labelCol&quot; :wrapperCol=&quot;wrapperCol&quot;&gt;</span><br><span class="line">     &lt;j-select-venu  v-decorator=&quot;[&apos;venueId&apos; ,validatorRules.venueId]&quot; :multiple=&quot;false&quot; placeholder=&quot;请输入邀约场馆&quot; @change=&quot;getVId&quot; /&gt;</span><br><span class="line">   &lt;/a-form-item&gt;</span><br><span class="line">   &lt;a-form-item label=&quot;邀约品牌&quot; :labelCol=&quot;labelCol&quot; :wrapperCol=&quot;wrapperCol&quot;&gt;</span><br><span class="line">     &lt;j-select-brand-rely v-decorator=&quot;[&apos;brandId&apos;, validatorRules.brandId]&quot; placeholder=&quot;请输入邀约品牌&quot; @change=&quot;getBId&quot;</span><br><span class="line">     :multiple=&quot;false&quot;/&gt;</span><br><span class="line">   &lt;/a-form-item&gt;</span><br><span class="line">   &lt;a-form-item label=&quot;邀约到馆时间&quot; :labelCol=&quot;labelCol&quot; :wrapperCol=&quot;wrapperCol&quot;&gt;</span><br><span class="line">     &lt;a-date-picker</span><br><span class="line">       placeholder=&quot;请选择邀约到馆时间&quot;</span><br><span class="line">       @change=&quot;getweek&quot;</span><br><span class="line">       :triggerChange=&quot;true&quot; </span><br><span class="line">       v-decorator=&quot;[&apos;offerTime&apos;, validatorRules.offerTime]&quot;</span><br><span class="line">       show-time</span><br><span class="line">       format=&quot;YYYY-MM-DD HH:mm&quot;</span><br><span class="line">       style=&quot;width: 100%&quot;</span><br><span class="line">     /&gt;</span><br><span class="line">   &lt;/a-form-item&gt;</span><br><span class="line">   &lt;a-form-item label=&quot;邀约班级&quot; :labelCol=&quot;labelCol&quot; :wrapperCol=&quot;wrapperCol&quot;&gt;</span><br><span class="line">     &lt;j-select-class-rely v-decorator=&quot;[&apos;classManagerId&apos;]&quot; </span><br><span class="line">       placeholder=&quot;请输入邀约班级&quot;</span><br><span class="line">       :disabled=&quot; ! ( hadChoose1 &amp;&amp; hadChoose2 &amp;&amp; hadChoose3 ) &quot;</span><br><span class="line">       :multiple=&quot;false&quot;/&gt;</span><br><span class="line">   &lt;/a-form-item&gt;</span><br><span class="line">   </span><br><span class="line">   methods:&#123;//绑定方法，利用vuex在平行组件之间传参</span><br><span class="line">   getweek(e)&#123;</span><br><span class="line">     e = `$&#123;this.moment(e).day()&#125;`</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;,&apos;dayWeek&apos;)</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;, e)</span><br><span class="line">     this.hadChoose1 = true</span><br><span class="line">   &#125;,</span><br><span class="line">   getVId(e)&#123;</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;,&apos;corresVenues&apos;)</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;, e)</span><br><span class="line"></span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;,&apos;venueId&apos;)</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;, e)</span><br><span class="line"></span><br><span class="line">     this.hadChoose2 = true</span><br><span class="line">   &#125;,</span><br><span class="line">   getBId(e)&#123;</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;,&apos;brand&apos;)</span><br><span class="line">     this.$store.commit(&apos;GetDetail&apos;, e)</span><br><span class="line">     this.hadChoose3 = true</span><br><span class="line">     // this.$set(this.rely,&apos;BId&apos;,e)</span><br><span class="line">   &#125;,</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>我们将轮子复制出一层，为JSelectBizComponentDetail<br>我们在JSelectBizComponentDetail/JSelectBizComponent.vue的computed里写好如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Rely()&#123;</span><br><span class="line">  let arr = this.$store.getters.detail</span><br><span class="line">  let arr_o = arr.filter((item,index)=&gt;&#123;</span><br><span class="line">    return index%2 === 0</span><br><span class="line">  &#125;)</span><br><span class="line">  let arr_j = arr.filter((item,index)=&gt;&#123;</span><br><span class="line">    return index%2 != 0</span><br><span class="line">  &#125;)</span><br><span class="line">  let rely = arr_o.map((item,index)=&gt;&#123;</span><br><span class="line">    let val = arr_j[index]</span><br><span class="line">    return&#123;</span><br><span class="line">      name:item,</span><br><span class="line">      val:val</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  //rely从[&apos;venueId&apos;,&apos;12334444564444&apos;]变成了[&#123;name:&apos;venueId&apos;,val:&apos;12334444564444&apos;&#125;]</span><br><span class="line">  rely = rely.reverse()//倒序是因为之前用的push方法，最后选择的放在了末尾，末尾的数据反而是需要筛选的数据。</span><br><span class="line">  let arr3 = []</span><br><span class="line">  rely = rely.reduce((item, next) =&gt; &#123;</span><br><span class="line">    if(arr3.indexOf(next.name) === -1)&#123;</span><br><span class="line">      item.push(next)</span><br><span class="line">      arr3.push(next.name)//以最终选择略过之前的选择</span><br><span class="line">    &#125;</span><br><span class="line">    return item;</span><br><span class="line">  &#125;, []);</span><br><span class="line">  return rely</span><br><span class="line">&#125;,</span><br><span class="line">Column_bool()&#123;</span><br><span class="line">  let obj = this.dataSource[0]</span><br><span class="line">  let arr = []</span><br><span class="line">  for(let idx in obj)&#123;</span><br><span class="line">    arr.push(idx)</span><br><span class="line">  &#125;</span><br><span class="line">  let str = arr.join(&apos;.&apos;)</span><br><span class="line">  //依然是判断datasource的json对象里有无这个id</span><br><span class="line">  return str</span><br><span class="line">&#125;,</span><br><span class="line">dataS()&#123;//a-table不再绑定dataSource，而是dataS</span><br><span class="line">  let bol = this.Column_bool</span><br><span class="line">  let rely = this.Rely</span><br><span class="line">  if(rely)&#123;</span><br><span class="line">    let arr = this.dataSource</span><br><span class="line">    rely.map((item)=&gt;&#123;</span><br><span class="line">      let name = item.name</span><br><span class="line">      let val = item.val</span><br><span class="line">      if(bol.indexOf(name)&gt;0)&#123;</span><br><span class="line">      arr = arr.filter((item)=&gt;&#123; return item[name] === val &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    return arr</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    return this.dataSource</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><br>最后一步:<br><span style="font-weight:bold;font-style:italic;color:#5f9296;">我们需要监听父modal的visible,visible为false的时候，我们需要清空detail</span><br>这个代码这里就不多赘述了。<p style="color:#59755e;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">表单内嵌子表单，完成增删改查</p>大体如下：<p></p>
<p><img src="/2020/08/23/6-7-8工作总结（say-goodbye-to-dunxi）/forms.png" alt="码云个人主页">点击父表单的某一条记录的编辑的时候又变成这样，即关联的子表单记录能够显示，编辑，新增，删除。</p>
<p><img src="/2020/08/23/6-7-8工作总结（say-goodbye-to-dunxi）/forms2.png" alt="码云个人主页"><br>这个modal的代码是我修改样例得到的，加了一些具体的方法，同时因为工艺流程和另外一列都要用到数据字典，需要单独写。这里记录一下具体代码。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line">//内嵌的表单</span><br><span class="line">&lt;a-row :gutter=&quot;[24,8]&quot;&gt;</span><br><span class="line">  &lt;a-col :span=&quot;24&quot;&gt;</span><br><span class="line">    &lt;a-table :columns=&quot;columns&quot; :dataSource=&quot;dataProinfo&quot; :pagination=&quot;false&quot; size=&quot;small&quot;&gt;</span><br><span class="line">      &lt;template slot=&quot;processFlow&quot; slot-scope=&quot;text, record&quot;&gt;</span><br><span class="line">        &lt;j-dict-select-tag</span><br><span class="line">          :triggerChange=&quot;true&quot;</span><br><span class="line">          key=&quot;processFlow&quot;</span><br><span class="line">          v-if=&quot;record.editable&quot;</span><br><span class="line">          style=&quot;margin: -5px 0&quot;</span><br><span class="line">          :value=&quot;record.processFlow&quot;</span><br><span class="line">          :select=&quot;&apos;radio&apos;&quot;</span><br><span class="line">          dictCode=&quot;processRecordFlow&quot;</span><br><span class="line">          @change=&quot;e =&gt; handleChange(e, record.key, `processFlow`)&quot;</span><br><span class="line">          placeholder=&quot;请输入工艺流程&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;template v-else&gt;&lt;/template&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template slot=&quot;processTime&quot; slot-scope=&quot;text, record&quot;&gt;</span><br><span class="line">        &lt;j-date</span><br><span class="line">          :trigger-change=&quot;true&quot;</span><br><span class="line">          key=&quot;processTime&quot;</span><br><span class="line">          v-if=&quot;record.editable&quot;</span><br><span class="line">          style=&quot;margin: -5px 0&quot;</span><br><span class="line">          :value=&quot;text&quot;</span><br><span class="line">          placeholder=&quot;日期&quot;</span><br><span class="line">          @change=&quot;e =&gt; handleChange(e, record.key, &apos;processTime&apos;)&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;template v-else&gt;&lt;/template&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template</span><br><span class="line">        v-for=&quot;(col, i) in [&apos;vehicleNumber&apos;,&apos;machineNumber&apos;,&apos;comment&apos;]&quot;</span><br><span class="line">        :slot=&quot;col&quot;</span><br><span class="line">        slot-scope=&quot;text, record&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;a-input</span><br><span class="line">          :key=&quot;col&quot;</span><br><span class="line">          v-if=&quot;record.editable&quot;</span><br><span class="line">          style=&quot;margin: -5px 0&quot;</span><br><span class="line">          :value=&quot;text&quot;</span><br><span class="line">          :placeholder=&quot;columns.slice(2)[i].title&quot;</span><br><span class="line">          @change=&quot;e =&gt; handleChange(e.target.value, record.key, col)&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;template v-else&gt;&lt;/template&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template slot=&quot;operation&quot; slot-scope=&quot;text, record&quot;&gt;</span><br><span class="line">        &lt;template v-if=&quot;record.editable&quot;&gt;</span><br><span class="line">          &lt;span v-if=&quot;record.isNew&quot;&gt;</span><br><span class="line">            &lt;a @click=&quot;saveRow(record.key)&quot;&gt;添加&lt;/a&gt;</span><br><span class="line">            &lt;a-divider type=&quot;vertical&quot; /&gt;</span><br><span class="line">            &lt;a-popconfirm title=&quot;是否要删除此行？&quot; @confirm=&quot;remove(record.key)&quot;&gt;</span><br><span class="line">              &lt;a&gt;删除&lt;/a&gt;</span><br><span class="line">            &lt;/a-popconfirm&gt;</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">          &lt;span v-else&gt;</span><br><span class="line">            &lt;a @click=&quot;saveRow(record.key)&quot;&gt;保存&lt;/a&gt;</span><br><span class="line">            &lt;a-divider type=&quot;vertical&quot; /&gt;</span><br><span class="line">            &lt;a @click=&quot;cancel(record.key)&quot;&gt;取消&lt;/a&gt;</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;span v-else&gt;</span><br><span class="line">          &lt;a @click=&quot;toggle(record.key)&quot;&gt;编辑&lt;/a&gt;</span><br><span class="line">          &lt;a-divider type=&quot;vertical&quot; /&gt;</span><br><span class="line">          &lt;a-popconfirm title=&quot;是否要删除此行？&quot; @confirm=&quot;remove(record.key)&quot;&gt;</span><br><span class="line">            &lt;a&gt;删除&lt;/a&gt;</span><br><span class="line">          &lt;/a-popconfirm&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/a-table&gt;</span><br><span class="line">    &lt;a-button</span><br><span class="line">      style=&quot;width: 100%; margin-top: 16px; margin-bottom: 8px&quot;</span><br><span class="line">      type=&quot;dashed&quot;</span><br><span class="line">      icon=&quot;plus&quot;</span><br><span class="line">      @click=&quot;newMember&quot;</span><br><span class="line">    &gt;新增工艺流程&lt;/a-button&gt;</span><br><span class="line">  &lt;/a-col&gt;</span><br><span class="line">&lt;/a-row&gt;</span><br><span class="line"></span><br><span class="line">data() &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    processFlow: [&apos;配布&apos;, &apos;退布&apos;, &apos;预定&apos;, &apos;染色&apos;, &apos;脱水&apos;, &apos;剖布&apos;, &apos;理布&apos;, &apos;定型&apos;, &apos;打卷&apos;, &apos;入库&apos;],</span><br><span class="line">    dataProinfo:[],</span><br><span class="line">    columns: [</span><br><span class="line">      &#123;</span><br><span class="line">        title: &apos;工艺流程&apos;,</span><br><span class="line">        align: &apos;center&apos;,</span><br><span class="line">        width: &apos;15%&apos;,</span><br><span class="line">        dataIndex: &apos;processFlow&apos;,</span><br><span class="line">        scopedSlots: &#123; customRender: &apos;processFlow&apos; &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        title: &apos;日期&apos;,</span><br><span class="line">        align: &apos;center&apos;,</span><br><span class="line">        width: &apos;18%&apos;,</span><br><span class="line">        dataIndex: &apos;processTime&apos;,</span><br><span class="line">        scopedSlots: &#123; customRender: &apos;processTime&apos; &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        title: &apos;车号&apos;,</span><br><span class="line">        align: &apos;center&apos;,</span><br><span class="line">        width: &apos;20%&apos;,</span><br><span class="line">        dataIndex: &apos;vehicleNumber&apos;,</span><br><span class="line">        scopedSlots: &#123; customRender: &apos;vehicleNumber&apos; &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        title: &apos;机台号&apos;,</span><br><span class="line">        align: &apos;center&apos;,</span><br><span class="line">        width: &apos;20%&apos;,</span><br><span class="line">        dataIndex: &apos;machineNumber&apos;,</span><br><span class="line">        scopedSlots: &#123; customRender: &apos;machineNumber&apos; &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        title: &apos;备注&apos;,</span><br><span class="line">        align: &apos;center&apos;,</span><br><span class="line">        width: &apos;10%&apos;,</span><br><span class="line">        dataIndex: &apos;comment&apos;,</span><br><span class="line">        scopedSlots: &#123; customRender: &apos;comment&apos; &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        title: &apos;操作&apos;,</span><br><span class="line">        key: &apos;action&apos;,</span><br><span class="line">        align: &apos;center&apos;,</span><br><span class="line">        scopedSlots: &#123; customRender: &apos;operation&apos; &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line">methods:&#123;</span><br><span class="line">  //内嵌表单所用的方法</span><br><span class="line">  newMember() &#123;</span><br><span class="line">    this.dataProinfo.push(&#123;</span><br><span class="line">      key: Math.random().toString().slice(3, 8),</span><br><span class="line">      processFlow: &apos;&apos;,</span><br><span class="line">      processTime: &apos;&apos;,</span><br><span class="line">      vehicleNumber: &apos;&apos;,</span><br><span class="line">      machineNumber: &apos;&apos;,</span><br><span class="line">      editable: true,</span><br><span class="line">      comment: &apos;&apos;,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  remove(key) &#123;</span><br><span class="line">    //如果要删除就直接删除</span><br><span class="line">    const newData = this.dataProinfo.filter((item) =&gt; item.key !== key)</span><br><span class="line">    const removeId = this.dataProinfo.filter((item) =&gt; item.key === key)[0].id</span><br><span class="line">    this.dataProinfo = newData</span><br><span class="line">    if (removeId) &#123;</span><br><span class="line">      deleteAction(`/production/fabricProcessRecordInfo/delete?id=$&#123;removeId&#125;`).then((res) =&gt; &#123;</span><br><span class="line">        if (res.success) &#123;</span><br><span class="line">          // this.ProinfoGet()</span><br><span class="line">          console.log(`$&#123;removeId&#125;删除成功`)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          console.log(`$&#123;removeId&#125;删除失败`)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  saveRow(key) &#123;</span><br><span class="line">    let target = this.dataProinfo.filter((item) =&gt; item.key === key)[0]</span><br><span class="line">    target.editable = false</span><br><span class="line">    target.isNew = false</span><br><span class="line">  &#125;,</span><br><span class="line">  toggle(key) &#123;</span><br><span class="line">    let target = this.dataProinfo.filter((item) =&gt; item.key === key)[0]</span><br><span class="line">    target.editable = !target.editable</span><br><span class="line">  &#125;,</span><br><span class="line">  getRowByKey(key, newData) &#123;</span><br><span class="line">    const data = this.dataProinfo</span><br><span class="line">    return (newData || data).filter((item) =&gt; item.key === key)[0]</span><br><span class="line">  &#125;,</span><br><span class="line">  cancel(key) &#123;</span><br><span class="line">    let target = this.dataProinfo.filter((item) =&gt; item.key === key)[0]</span><br><span class="line">    target.editable = false</span><br><span class="line">  &#125;,</span><br><span class="line">  handleChange(value, key, column) &#123;</span><br><span class="line">    const newData = [...this.dataProinfo]</span><br><span class="line">    const target = newData.filter((item) =&gt; key === item.key)[0]</span><br><span class="line">    if (target) &#123;</span><br><span class="line">      target[column] = value</span><br><span class="line">      this.dataProinfo = newData</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(this.dataProinfo)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  ProinfoGet() &#123;</span><br><span class="line">    let pro_id = this.model.productionNo//父记录的生产单号，关联出子记录的工艺流程</span><br><span class="line">    if(pro_id)&#123;</span><br><span class="line">      getAction(`/production/fabricProcessRecordInfo/list?productionNo=$&#123;pro_id&#125;`).then((res) =&gt; &#123;</span><br><span class="line">        if (res.success) &#123;</span><br><span class="line">          this.dataProinfo = res.result.records.map((item)=&gt;&#123;</span><br><span class="line">              return&#123;</span><br><span class="line">                ...item,</span><br><span class="line">                key:Math.random().toString().slice(3,8),</span><br><span class="line">                editable:false</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">          console.log(`$&#123;pro_id&#125;加载成功`)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          console.log(`$&#123;pro_id&#125;加载失败`)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  ProinfoPost() &#123;</span><br><span class="line">    let pro_id = this.model.productionNo</span><br><span class="line">    if (this.dataProinfo.length) &#123;</span><br><span class="line">      //需要编辑的数据</span><br><span class="line">      let datas = this.dataProinfo.filter((item) =&gt; &#123;</span><br><span class="line">        return item.id</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      //需要新增的数据</span><br><span class="line">      let datas2 = this.dataProinfo.filter((item) =&gt; &#123;</span><br><span class="line">        return !item.id</span><br><span class="line">      &#125;)</span><br><span class="line">      let newData2 = datas2.map((item) =&gt; &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          productionNo: pro_id,</span><br><span class="line">          processFlow: item.processFlow,</span><br><span class="line">          processTime: item.processTime,</span><br><span class="line">          vehicleNumber: item.vehicleNumber,</span><br><span class="line">          machineNumber: item.machineNumber,</span><br><span class="line">          comment: item.comment,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  </span><br><span class="line">      for (let i in newData2) &#123;</span><br><span class="line">        postAction(`/production/fabricProcessRecordInfo/add`, newData2[i]).then((res) =&gt; &#123;</span><br><span class="line">          if (res.success) &#123;</span><br><span class="line">            console.log(i + &apos;ok&apos;)</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            console.log(i + &apos;no&apos;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      for (let i in datas) &#123;</span><br><span class="line">        console.log(datas[i])</span><br><span class="line">        putAction(`/production/fabricProcessRecordInfo/edit`, datas[i]).then((res) =&gt; &#123;</span><br><span class="line">          if (res.success) &#123;</span><br><span class="line">            console.log(i + &apos;ok&apos;)</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            console.log(i + &apos;no&apos;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><br>以上只是那个页面的一半，另一半就是Jeecg-boot已经封装好的增删改查，没有记录意义。</p><p style="color:#59755e;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">Base64（Blob转Base64）</p><p style="color:#91a76e;font-weight:bold">富文本编辑器的坑</p>如果想以base64编码转换图片存入数据库的话，需要用到canvas绘图。（说实话canvas我一直没学，因为会svg所以觉得没必要学，也许有一天会纳入我的学习路线吧）这些方法都是查找CSDN得来的，只是我使用到Jeecg-boot里费了好大一番功夫。由于全是我写的，所以直接PO上完整Vue    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;a-button icon=&quot;plus&quot; @click=&quot;addNote&quot;&gt;新增&lt;/a-button&gt;</span><br><span class="line">    &lt;a-modal v-model=&quot;visible&quot; on-ok=&quot;handleOk&quot; :width=&quot;width&quot;&gt;</span><br><span class="line">      &lt;a-spin :spinning=&quot;confirmLoading&quot;&gt;</span><br><span class="line">        &lt;a-row class=&quot;mgt&quot;&gt;</span><br><span class="line">          &lt;a-col :span=&quot;24&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;ed mgt&quot;&gt;</span><br><span class="line">              &lt;a-input v-model=&quot;headline&quot;/&gt;</span><br><span class="line">              &lt;Vueditor class=&quot;editor mgt&quot; id=&quot;editor&quot; ref=&quot;content&quot;&gt;&lt;/Vueditor&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/a-col&gt;</span><br><span class="line">        &lt;/a-row&gt;</span><br><span class="line">      &lt;/a-spin&gt;</span><br><span class="line">      &lt;template slot=&quot;footer&quot;&gt;</span><br><span class="line">        &lt;a-button key=&quot;back&quot; @click=&quot;handleCancel&quot;&gt;取消&lt;/a-button&gt;</span><br><span class="line">        &lt;a-button key=&quot;submit&quot; :loading=&quot;loading&quot; @click=&quot;Into()&quot;&gt;确认发布&lt;/a-button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/a-modal&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; postAction &#125; from &apos;@/api/manage&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        loading: false,</span><br><span class="line">        visible: false,</span><br><span class="line">        width: 900,</span><br><span class="line">        confirmLoading:false,</span><br><span class="line">        headline:&apos;&apos;,</span><br><span class="line">        simpleContent:&apos;&apos;,</span><br><span class="line">        temp:[],</span><br><span class="line">        src_img:[],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    temp: &#123;</span><br><span class="line">      handler: function(newVal, oldVal) &#123;</span><br><span class="line">        let rel_content = &apos;&apos;;</span><br><span class="line">        let src_img = this.src_img;</span><br><span class="line">        if(newVal.length === this.src_img.length || this.temp[0] === &quot;keys&quot;)&#123;</span><br><span class="line">          rel_content = this.$refs[&apos;content&apos;].getContent()</span><br><span class="line">          for(let i in newVal)&#123;</span><br><span class="line">            rel_content = rel_content.replace(src_img[i],newVal[i])</span><br><span class="line">            //console.log(newVal[i])</span><br><span class="line">            //console.log(src_img[i])</span><br><span class="line">          &#125;</span><br><span class="line">          this.rel_content = rel_content</span><br><span class="line">          this.loading = true</span><br><span class="line">          this.sendNote()</span><br><span class="line">          this.loading = false</span><br><span class="line">          this.visible = false</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      deep: true</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    Into()&#123;</span><br><span class="line">      //图片寻找，替换，base64</span><br><span class="line">      </span><br><span class="line">      let self = this</span><br><span class="line">      let str = self.$refs[&apos;content&apos;].getContent();</span><br><span class="line">      let str2 = str</span><br><span class="line">      let imgReg = /&lt;img.*?(?:&gt;|\/&gt;)/gi;</span><br><span class="line">      //匹配src属性</span><br><span class="line">      let srcReg = /src=[\&apos;\&quot;]?([^\&apos;\&quot;]*)[\&apos;\&quot;]?/i;</span><br><span class="line">      let arr = str.match(imgReg);//拿到图片数组</span><br><span class="line">      </span><br><span class="line">      if(arr)&#123;</span><br><span class="line">        let src_s = arr.map(item=&gt;item.match(srcReg))</span><br><span class="line">        let src_img  = src_s.map(item=&gt;item[1])</span><br><span class="line">        this.src_img = src_img</span><br><span class="line">        let arr_imgs = src_img.map(item=&gt;self.getImgBase64(item))</span><br><span class="line"></span><br><span class="line">        for(let i in arr)&#123;</span><br><span class="line">        str2 = str2.replace(arr[i],&apos;&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">        str2 = str2.replace(/&lt;\/?.+?&gt;/g,&quot;&quot;);</span><br><span class="line">        str2 = str2.replace(/ /g,&quot;&quot;);//为得到后的内容</span><br><span class="line">        str2 = str2.replace(/&amp;nbsp;/g,&quot;&quot;)</span><br><span class="line">        self.simpleContent = str2</span><br><span class="line"></span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        this.temp.push(&quot;keys&quot;)</span><br><span class="line"></span><br><span class="line">        str2 = str2.replace(/&lt;\/?.+?&gt;/g,&quot;&quot;);</span><br><span class="line">        str2 = str2.replace(/ /g,&quot;&quot;);//dds为得到后的内容</span><br><span class="line">        str2 = str2.replace(/&amp;nbsp;/g,&quot;&quot;)</span><br><span class="line">        self.simpleContent = str2</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    async getImgBase64(url)&#123;</span><br><span class="line">        let self = this</span><br><span class="line">        let img = new Image();</span><br><span class="line">        let temp = []</span><br><span class="line">        let base64 = &apos;&apos;</span><br><span class="line">        img.src=url</span><br><span class="line">        img.onload = async function()&#123;</span><br><span class="line">          let base64 = self.image2Base64(img)</span><br><span class="line">        &#125;</span><br><span class="line">        return base64</span><br><span class="line">        //此处并没有办法返回真正的base64的流，数组为空</span><br><span class="line">    &#125;,</span><br><span class="line">    async image2Base64(img)&#123;</span><br><span class="line">        let canvas = document.createElement(&quot;canvas&quot;);</span><br><span class="line">        canvas.width = (img.width/1.5);</span><br><span class="line">        canvas.height = (img.height/1.5);</span><br><span class="line">        let ctx = canvas.getContext(&quot;2d&quot;);</span><br><span class="line">        ctx.drawImage(img, 0, 0, img.width/1.5, img.height/1.5);</span><br><span class="line">        let dataURL = await canvas.toDataURL(&quot;image/png&quot;);</span><br><span class="line">        this.temp.push(dataURL)//转换后的base64存入全局数组temp</span><br><span class="line">        return dataURL;</span><br><span class="line">    &#125;,</span><br><span class="line">    sendNote:function()&#123;</span><br><span class="line">        let content = this.rel_content</span><br><span class="line">        let headline = this.headline</span><br><span class="line">        let simpleContent = this.simpleContent</span><br><span class="line">      //let ti = moment(new Date()).format(&apos;YYYY-MM-DD&apos;)</span><br><span class="line">      console.log(simpleContent)</span><br><span class="line">      postAction(&apos;/common/fabricNotepad/add&apos;,&#123;</span><br><span class="line">          headline,</span><br><span class="line">          content,</span><br><span class="line">          simpleContent</span><br><span class="line">      &#125;).then((res) =&gt; &#123;</span><br><span class="line">          if(res.success)&#123;</span><br><span class="line">            this.$message.success(res.message)</span><br><span class="line">            this.$emit(&apos;load_aga&apos;)</span><br><span class="line">          &#125;else&#123;</span><br><span class="line">            this.$message.warning(res.message)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    addNote:function()&#123;</span><br><span class="line">      let self = this</span><br><span class="line">      this.visible = true</span><br><span class="line">      this.$refs[&quot;content&quot;].setContent(&apos;_&apos;)</span><br><span class="line">      this.headline = &apos;&apos;</span><br><span class="line">      </span><br><span class="line">    &#125;,</span><br><span class="line">    handleOk(e) &#123;</span><br><span class="line">      this.loading = true</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        this.visible = false</span><br><span class="line">        this.loading = false</span><br><span class="line">      &#125;, 3000)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleCancel(e) &#123;</span><br><span class="line">      this.visible = false</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.mgt&#123;</span><br><span class="line">  margin-top: 20px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><br> 说实话我是第一次碰到这种情况，直接替换[‘/x.png’]为<a href="太长太长了">‘data……………’</a>的时候，替换之后Array的长度是空的（可能因为JS先传值地址，再传值？）,此处是应该写异步的，但是不知道是我能力有限还是怎样，最后只能通过别的方法去达到目的，但是转换成base64并打印在控制台完全没有问题。所以我只能去监听替换之后的数组长度。具体流程就是<br><br><span style="color:rgb(35, 112, 58);font-size:15px;">1.通过富文本编辑器Vueditor的api:getContent()拿到内容-&gt;2.然后正则查找src:xxxx,但是match到的数据会有稍微偏差，过滤拿到需要的blob-&gt;3.转换成base64流，可能因为base64文本流太长太长了，所以函数当即执行的时候，返回的是空值-&gt;4.只能存入全局数组temp-&gt;5.监听temp长度-&gt;6.temp数组长度不再变化且不为0的时候，开始着手post数据-&gt;7.为了避免无图片temp为空值的情况，temp要push一个关键字，只要temp拿到了这个关键字，说明也可以开始post了</span><p style="color:#59755e;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">其他</p><p style="color:#91a76e;font-weight:bold">map,filter以及其他</p>日常中用到了好多数组处理方法，但是大部分都是这两个api，用了好多好多遍，但是即使我已经用了这么多遍，有的时候居然还是写错了。以下简单示例：老板要求用图表形式展示占用情况，但是后端只能只返回一个大数组，数组里每一个json都有场地名称，有时间段，有占用人。具体思路如下<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">let dataOr = names.map((item)=&gt;&#123;//names为场地名称，可以通过其他表拿到</span><br><span class="line">  let name = item</span><br><span class="line">  let arr_all = arr.filter((item)=&gt;&#123;//arr为把传过来的数组调整成时间段的格式而非小时，例如&apos;6&apos;转变为&apos;6-7&apos;,处理之后的数组</span><br><span class="line">    return item.landName === name</span><br><span class="line">  &#125;)</span><br><span class="line">  return &#123;</span><br><span class="line">    landName:name,//外循环用到的</span><br><span class="line">    info:arr_all//info是第二重循环需要用到的</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  let arr2 =  dataOr.map((item1)=&gt;&#123;</span><br><span class="line">    let arr = time.map((item2)=&gt;&#123;</span><br><span class="line">          let status = false</span><br><span class="line">          let ocperson = &apos;&apos;</span><br><span class="line">          item1.info.map((item3)=&gt;&#123;</span><br><span class="line">            if(item2 === item3.time)&#123;</span><br><span class="line">              status = true</span><br><span class="line">              ocperson = item3.occupyType</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">          return &#123;</span><br><span class="line">            time:item2,</span><br><span class="line">            status,</span><br><span class="line">            ocperson</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    return&#123;</span><br><span class="line">        landName:item1.landName,</span><br><span class="line">        info:arr</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">  </span><br></pre></td></tr></table></figure><br>    timeCut就是简单时间段，当需要B数组去match&nbsp;A数组的时候，就应该是A数组遍历。所以上述我写了timeCut.map(…)<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  timeCut()&#123;</span><br><span class="line">    let arr = [&apos;7-8&apos;,&apos;8-9&apos;,&apos;9-10&apos;,&apos;10-11&apos;,&apos;11-12&apos;,&apos;12-13&apos;,&apos;13-14&apos;,&apos;14-15&apos;,&apos;15-16&apos;,&apos;16-17&apos;,&apos;17-18&apos;,&apos;18-19&apos;,&apos;19-20&apos;,&apos;20-21&apos;,&apos;21-22&apos;]</span><br><span class="line">    return arr</span><br><span class="line">&#125;,</span><br><span class="line">  </span><br></pre></td></tr></table></figure><br>终于开始循环到页面里<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  &lt;a-row class=&quot;align&quot;&gt;</span><br><span class="line">    &lt;a-col class=&quot;col&quot;&gt;</span><br><span class="line">        &lt;a-row class=&quot;row-item&quot;&gt;时间段&lt;/a-row&gt;</span><br><span class="line">        &lt;a-row class=&quot;row-item&quot; :key=&quot;&apos;cut&apos;+idx&quot; v-for=&quot;(item,idx) in timeCut&quot;&gt;&lt;/a-row&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">    &lt;!--  --&gt;</span><br><span class="line">    &lt;a-col :key=&quot;index&quot; v-for=&quot;(item,index) in dataSource&quot; class=&quot;col&quot;&gt;</span><br><span class="line">        &lt;a-row class=&quot;row-item&quot;&gt;&lt;/a-row&gt;</span><br><span class="line">        &lt;a-row class=&quot;row-item cor2&quot; :key=&quot;&apos;info&apos;+idx&quot; v-for=&quot;(timeOc,idx) in item.info&quot; :style=&quot;&#123;background:timeOc.status?cor1:&apos;#ffffff&apos;&#125;&quot;&gt;</span><br><span class="line">           &lt;!--  --&gt;</span><br><span class="line">          </span><br><span class="line">        &lt;/a-row&gt;</span><br><span class="line">    &lt;/a-col&gt;</span><br><span class="line">&lt;/a-row&gt;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><br><span style="font-weight:bold;color:orange;">Notice: </span><span style="border-top: 1px dotted #ccffcc;color:orange">end,其他一些逻辑问题应该不值得我去记录，以后想起来了可以补充进去，这段时间还是学到蛮多东西的，其实只要学到了东西，时光就不算浪费 :)</span><p></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gsnwjd.github.io/2020/04/18/版式设计end作业/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="gsnwjd王佳典">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关四鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/04/18/版式设计end作业/" class="post-title-link" itemprop="url">版式设计end作业</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-04-18 11:39:06" itemprop="dateCreated datePublished" datetime="2020-04-18T11:39:06Z">2020-04-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-05-01 15:06:47" itemprop="dateModified" datetime="2020-05-01T15:06:47Z">2020-05-01</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="color:#8c8c8c;border-left:4px solid #fc568d;">&nbsp;&nbsp;——本文禁止转载,分享请注明网站出处: ）</span><br><br><span style="color:#707ad1;">这是我2019年6月版式设计课的结业作业，放在我的个人博客上记录一下。<br>可能我还是觉得手写笔记这种古早味儿的方式更加适合我，摆在博客上的东西都更郑重一些。<br>我觉得不行，我得改变我这种想法。。。</span><br><br><span style="font-weight:300;">由于原图太大，这里放的压缩版本</span><br><img src="/2020/04/18/版式设计end作业/gsn封-底.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn3-4.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn4-5.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn6-7.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn8-9.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn10-11.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn12-13.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn14-15.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn16-17.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn20-21.jpg" alt="版式"><br><img src="/2020/04/18/版式设计end作业/gsn22-23.jpg" alt="版式"></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gsnwjd.github.io/2020/04/17/沽存旅行社的“前世今生”/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="gsnwjd王佳典">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关四鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2020/04/17/沽存旅行社的“前世今生”/" class="post-title-link" itemprop="url">沽存旅行社的“前世今生”</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-04-17 15:27:37" itemprop="dateCreated datePublished" datetime="2020-04-17T15:27:37Z">2020-04-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-08-23 00:41:18" itemprop="dateModified" datetime="2020-08-23T00:41:18Z">2020-08-23</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="color:#8c8c8c;border-left:4px solid #b5f4ff;">&nbsp;&nbsp;——本文禁止转载,分享请注明网站出处: ）</span><br></p>
<p style="color:#ac9788;">(博客还未完成，但是项目地址有效，有空等我上传视频到B站 : )</p>回想起大一学的web程序设计（其实叫网页设计更加合适），由于是个选修课，大家都不怎么认真听，内容也仅仅限于HTML/HTML5+CSS/CSS3。而我在一整个学期的学习中，也从一开始的迷惑不解变成有了这个当做职业发展的念头。<br>我的结课作业做了一个旅行社的网站，主要功能就是旅游项目+分享旅游心得,它完全静态，只能展示。<br>那个时候的沽存旅行社是这个样子。<br><br><br>大一结束之后我学了jQuery和Vue，当时还为了能做数据交互学了PHP和MySQL，期间浅略地接触了boostrap，jQuery Easy UI,Backbone.js,underscore.js。Backbone感觉没用几年就被市场淘汰了，jQuery Easy UI封装得太完全，不是我想要的，这个应该是某个后端人员想要快速搭建网站时候才会拿来用一用吧。<br>然后慢慢地觉得自己好像站在前端知识的海洋里飘来飘去，找不到什么方向，我也知道前端变得很快，框架层出不穷。后来在慕课网学习了很多和前端相关的课程，比如Nodejs入门，如何与数据交互。比如用Vue全家桶+Koa搭建一个仿美团的全栈网站。<br>最后我把沽存旅行社找出来，打算重新做一遍。<br>它不再是一个静态的孤零零的网站，它开始有了微弱的生命，虽然我的技术也并不是多么棒，但是有很多细节，以及我为了解决一些问题所做出的努力使得它对于我有了独一无二的意义。<br><br>借助引擎：<span style="font-weight:bold;color:#7bbeca;">Nuxt.js</span>（官网<a href="https://nuxtjs.org/guide/installation" style="color:#5d5d51;" target="_blank" rel="noopener">-&gt;https://nuxtjs.org/guide/installation</a>）<br>项目地址：<a href="https://github.com/gsnwjd/gucun.git" style="color:#5d5d51;font-weight:bold;" target="_blank" rel="noopener">gucun</a>（仓库里包含了除了node模块之外所有的东西，如果要下载运行，需要npm install一下模块，且需要借助Redis和MongoDB）<br><p style="color:#655975;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">页面设计</p><br><p style="color:#6e7da7;font-weight:bold">开屏动画</p><br><p style="color:#6e7da7;font-weight:bold">选项改变-&gt;内容改变</p><br><p style="color:#6e7da7;font-weight:bold">折角动画</p>

<p></p><p style="color:#6e7da7;font-weight:bold">开屏动画2</p><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">个人空间背景图片</p><p></p>
<p></p><p style="color:#655975;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">博客必备：配置富文本器</p><p style="color:#6e7da7;font-weight:bold">问题一：window is not defined</p>通常在像nuxt，nest这样的引擎下，想要引入外部组件，要么存在Vuex里，要么只能作为插件引入，且需要在config里定义插件。本人找了一个比较简单的富文本编辑器Vueditor。<br>这里采用vuex的方法，借助了官方的例子（也就是npm.org里的例子），但是官方的例子浏览器会报警告。<br>这里采用另一种写法。    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">/*edit.js*/</span><br><span class="line">    import Vue from &apos;vue&apos;</span><br><span class="line">    import Vuex from &apos;vuex&apos;</span><br><span class="line">    Vue.use(Vuex);</span><br><span class="line">    </span><br><span class="line">    import Vueditor from &apos;vueditor&apos;</span><br><span class="line">    import &apos;vueditor/dist/style/vueditor.min.css&apos;</span><br><span class="line">    </span><br><span class="line">    // 编辑器配置</span><br><span class="line">    let config = &#123;</span><br><span class="line">      toolbar: [</span><br><span class="line">        &apos;removeFormat&apos;, &apos;undo&apos;, &apos;|&apos;, &apos;elements&apos;, &apos;fontName&apos;, &apos;fontSize&apos;, &apos;foreColor&apos;, &apos;backColor&apos;,&apos;|&apos;,&apos;bold&apos;, &apos;italic&apos;, &apos;underline&apos;,&apos;emoji&apos;, &apos;picture&apos;</span><br><span class="line">      ],</span><br><span class="line">      fontName: [</span><br><span class="line">        &#123;val: &apos;arial black&apos;&#125;, </span><br><span class="line">        &#123;val: &apos;times new roman&apos;&#125;, </span><br><span class="line">        &#123;val: &apos;Courier New&apos;&#125;</span><br><span class="line">      ],</span><br><span class="line">      fontSize: [&apos;12px&apos;, &apos;14px&apos;, &apos;16px&apos;, &apos;18px&apos;],</span><br><span class="line">      uploadUrl: ``,</span><br><span class="line">    &#125;;</span><br><span class="line">    let edit = Vue.use(Vueditor, config);</span><br><span class="line">    export default new Vuex.Store(&#123;</span><br><span class="line">      namespaced: true,</span><br><span class="line">      state:&#123;</span><br><span class="line">        edit</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">    /*</span><br><span class="line">    new Vue(&#123;</span><br><span class="line">      el: &apos;#editor1&apos;,</span><br><span class="line">    &#125;);</span><br><span class="line">    */</span><br></pre></td></tr></table></figure>然后再在store目录下的index里的  <span style="color:#965f83;">modules:{}</span>配置<p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">问题二：图片如何上传</p>在edit.js里有一个uploadUrl,在这里可以直接放下路由，请求后端，因为这个项目的后端也是我写，这里主要用了fs这个模块。    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">    /*富文本上传图片*/</span><br><span class="line">router.post(&apos;/img&apos;, async(ctx) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  try&#123;</span><br><span class="line"></span><br><span class="line">    const username = decodeURIComponent(ctx.session.passport.user.username)</span><br><span class="line">    let one = await Image.get(`$&#123;username&#125;temp`)</span><br><span class="line">    if(!one)&#123;</span><br><span class="line">      Image.set(`$&#123;username&#125;temp`,&apos;#&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;&#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    let dir_img=Math.random().toString().slice(3,8);</span><br><span class="line"></span><br><span class="line">    const file = ctx.request.files.image;</span><br><span class="line">    const reader = fs.createReadStream(file.path);</span><br><span class="line">    const ext = file.name.split(&apos;.&apos;).pop();     // 获取上传文件扩展名</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">      const upStream = fs.createWriteStream(`static/upload/temp/$&#123;dir_img&#125;.$&#123;ext&#125;`);  // 创建可写流</span><br><span class="line">      reader.pipe(upStream);// 可读流通过管道写入可写流</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    const img_val = &apos;#&apos;+`/upload/temp/$&#123;dir_img&#125;.$&#123;ext&#125;`</span><br><span class="line">    Image.append(`$&#123;username&#125;temp`,img_val)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ctx.body=`/upload/temp/$&#123;dir_img&#125;.$&#123;ext&#125;&quot; style=&quot;width:300px;`</span><br><span class="line">    //此路径完全返回给富文本编辑器页面上的那张上传的图片，为了防止图片过大影响编辑，于是加上width，等存入数据库的时候把这个内容替换为空。</span><br><span class="line">  &#125;catch(e)&#123;</span><br><span class="line">    ctx.body=&apos;error&apos;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">问题三：如何获取用户敲下的内容</p>vueditor模块自带api，推荐使用 <span style="color:rgb(136, 60, 76);font-style:italic;">this.$refs[“/<em>编辑器名称</em>/“].getContent()</span><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">问题四：如何拿到展示图片</p><span style="color:rgb(192, 104, 123);font-style:italic;">假定博客列表需要展示几张图片 : )</span><br><br>拿到展示图片有两种方法，一种是通过正则,在获取用户内容的时候找一找，然后把这个数组存储起来。<br>一种是在用户上传完图片的时候就把图片路径存储在redis里面，然后在用户点击提交的时候，把redis里存储的长字符串也放入MongoDB数据库，需要展示的时候就取出来切成数组，放在目录栏。<br>虽然我用的是第二种，但是我推荐第一种。正则如下。  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">let self = this</span><br><span class="line">  let str = self.$refs[&apos;content&apos;].getContent();</span><br><span class="line">  let imgReg = /&lt;img.*?(?:&gt;|\/&gt;)/gi;</span><br><span class="line">  //匹配src属性</span><br><span class="line">  let srcReg = /src=[\&apos;\&quot;]?([^\&apos;\&quot;]*)[\&apos;\&quot;]?/i;</span><br><span class="line">  let arr = str.match(imgReg);</span><br><span class="line"></span><br><span class="line">  if(arr)&#123;</span><br><span class="line">    let src_s = arr.map(item=&gt;item.match(srcReg))</span><br><span class="line">    //console.log(src_s)</span><br><span class="line">    let src_img  = src_s.map(item=&gt;item[1])</span><br><span class="line">    this.src_img = src_img</span><br><span class="line">    let arr_imgs = src_img.map(item=&gt;self.getImgBase64(item))</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    this.temp.push(&quot;keys&quot;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>我推荐正则，但是我并不知道是把图片转换成base64存入数据库更好还是直接上传到服务器更好。<p></p>
<p></p><p style="color:#655975;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">数据设计</p><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">首页：内容的“换一换”</p><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">省份地址用VueX存储</p><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">有无keywords展示的页面</p><p></p>
<p></p><p style="color:#655975;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">组件设计</p><p style="color:#6e7da7;font-weight:bold">一个可以到处用的头像组件</p><br>组件如下    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template lang=&quot;html&quot;&gt;</span><br><span class="line">  &lt;div :class=&quot;&#123;headimg:suit,bigheadimg:nosuit&#125;&quot; :style=&quot;&#123;backgroundImage: bg&#125;&quot;&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">      props:[&apos;auhead&apos;,&apos;suit&apos;],</span><br><span class="line">      computed:&#123;</span><br><span class="line">        bg:function()&#123;</span><br><span class="line">            return `url($&#123;this.auhead&#125;)`</span><br><span class="line">      &#125;,</span><br><span class="line">      nosuit:function()&#123;</span><br><span class="line">        if(this.suit)&#123;</span><br><span class="line">          return false</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">          return true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;style&gt;</span><br><span class="line">  .headimg&#123;</span><br><span class="line">      border-radius: 50%;</span><br><span class="line">      width:36px;</span><br><span class="line">      height:36px;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      float: left;</span><br><span class="line">  </span><br><span class="line">      background-repeat: no-repeat;</span><br><span class="line">      background-size: auto 150%;</span><br><span class="line">      background-position:50% 50%;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  .bigheadimg&#123;</span><br><span class="line">      border-radius: 50%;</span><br><span class="line">      width:70px;</span><br><span class="line">      height:70px;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">      float: left;</span><br><span class="line">  </span><br><span class="line">      background-repeat: no-repeat;</span><br><span class="line">      background-size: auto 140%;</span><br><span class="line">      background-position:50% 50%;</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><span style="color:rgb(99, 81, 129);font-size:15px;">博客项目中可以说是处处有头像</span><p></p>
<p></p><p style="color:#6e7da7;font-weight:bold">SVG星星评分组件</p>我用AI画了一颗星星然后导出为svg，当然大家也可以直接去icons8上找svg图标。 <span style="color:rgb(192, 104, 123);font-style:italic;font-weight: bolder;">star_val.vue</span><br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;template lang=&quot;html&quot;&gt;</span><br><span class="line">  &lt;div id=&quot;str&quot;&gt;</span><br><span class="line">      &lt;svg id=&quot;图层_1&quot; data-name=&quot;图层 1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 50 50&quot;&gt;</span><br><span class="line">          &lt;path class=&quot;cls-1&quot; d=&quot;M21.46,11.78l-3.41,6.31a2.27,2.27,0,0,1-1.71,1.19l-5,.72a2.32,2.32,0,0,0-1,4.19L15,27.46a2.31,2.31,0,0,1,.81,2.79l-2,4.77a2.31,2.31,0,0,0,3.1,3L23.53,35a2.35,2.35,0,0,1,1.94,0l6.82,3.14a2.32,2.32,0,0,0,3.13-2.94L33.13,29.3a2.34,2.34,0,0,1,.76-2.69l3.2-2.43A2.31,2.31,0,0,0,36,20.05l-5.35-.77A2.27,2.27,0,0,1,29,18.09l-3.41-6.31A2.31,2.31,0,0,0,21.46,11.78Z&quot;/&gt;</span><br><span class="line">      &lt;/svg&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;script&gt;</span><br><span class="line">  </span><br><span class="line">  export default &#123;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;style&gt;</span><br><span class="line">  #str&#123;</span><br><span class="line">    float:left;</span><br><span class="line">    width:20px;</span><br><span class="line">    height:20px;</span><br><span class="line">  &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><span style="color:rgb(192, 104, 123);font-style:italic;font-weight: bolder;">star.vue</span>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template lang=&quot;html&quot;&gt;</span><br><span class="line">  &lt;span class=&quot;star&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;star_fl&quot; v-if=&quot;num==5&quot;&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;star_fl&quot; v-else-if=&quot;num==4&quot;&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;star_fl&quot; v-else-if=&quot;num==3&quot;&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;star_fl&quot; v-else-if=&quot;num==2&quot;&gt;&lt;Starval/&gt;&lt;Starval/&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;star_fl&quot; v-else=&quot;num==1&quot;&gt;&lt;Starval/&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/span&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;script&gt;</span><br><span class="line">  import Starval from &apos;~/components/public/star_val.vue&apos;</span><br><span class="line">  export default &#123;</span><br><span class="line">  </span><br><span class="line">      components:&#123;</span><br><span class="line">          Starval</span><br><span class="line">      &#125;,</span><br><span class="line">      props:[&apos;num&apos;]</span><br><span class="line">  </span><br><span class="line">      &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;style&gt;</span><br><span class="line">  .star_fl&#123;</span><br><span class="line">      display: inline-block;</span><br><span class="line">      height:23px;</span><br><span class="line">      width:100px;</span><br><span class="line">      margin-left:10px; </span><br><span class="line">  &#125;</span><br><span class="line">  .cls-1&#123;fill:#ffed9d;stroke:#c7b289;stroke-miterlimit:10;&#125;</span><br><span class="line">  &lt;/style&gt;</span><br></pre></td></tr></table></figure><p></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gsnwjd.github.io/2019/08/18/NodeJs基础入门实录（上）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="gsnwjd王佳典">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关四鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/18/NodeJs基础入门实录（上）/" class="post-title-link" itemprop="url">NodeJs基础入门实录（上）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-18 01:36:00" itemprop="dateCreated datePublished" datetime="2019-08-18T01:36:00Z">2019-08-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-04-18 07:51:52" itemprop="dateModified" datetime="2020-04-18T07:51:52Z">2020-04-18</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="color:#8c8c8c;border-left:4px solid #f2f233;">&nbsp;&nbsp;——本文禁止转载,分享请注明网站出处 : )</span><br><br><br>在6月21日至7月31日之间，我通过网课和官方文档学习了nodejs的基本知识，包括一些基本模块，express框架，模板ejs，jade和数据库（MySQL）方面的用法，顺带一提的是，express处理数据的无限回调令人头(zuo)大(ou)，幸好koa框架更加人性化，但是网课里用的是express，所以这里只打算记录一下express。<br>之后我会记录koa框架+SSR浏览器端渲染数据的教程</p>
<p></p><p style="color:#85826c;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">基础模块</p><br>除了nodejs之外我们还需要安装以下工具<br>npm:包/模块管理器<br>Git Bash:更方便地执行linux命令，不用面对难用的cmd<br><span style="color:#97ac70;">如果不会安装，可以去知乎/掘金上查找教程。</span><br><br><span style="color:#b4dace;">一些必备常识:</span><br>盘符：<span style="border-bottom:1px solid #2ead87;">e:&nbsp;<br></span><br>进入文件夹：<span style="border-bottom:1px solid #2ead87;">cd&nbsp;&nbsp;e:/test/<br></span><br>启动js文件：<span style="border-bottom:1px solid #2ead87;">node&nbsp;server.js<br></span><br>下载依赖模块：<span style="border-bottom:1px solid #2ead87;">npm&nbsp;i&nbsp;模块名(例如：body-parser)<br></span><br>监听：<span style="border-bottom:1px solid #2ead87;">server.listen(端口号);<br></span><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">HTTP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const http=require(&apos;http&apos;);//1.引入模块</span><br><span class="line">var server=http.createServer(function (request, response)&#123;</span><br><span class="line">  console.log(&apos;node&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">//2.监听——等着</span><br><span class="line">//端口-数字</span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure><br><span style="color:goldenrod;">然后将上述内容保存为server.js，以下有两种方法来启动server.js</span><br><br><span style="color:rgb(58, 167, 167);font-style:italic;">1.</span><br><span style="color:rgb(38, 112, 112);">点击VScode菜单栏倒数第二个选项：终端。我们选择新建终端，在终端处输入node server.js。</span><br><br><span style="color:rgb(58, 167, 167);font-style:italic;">2.</span><br><span style="color:rgb(38, 112, 112);">在文件资源管理器处打开server.js所在文件夹，然后右键点击文件夹空白处，选择<span style="border:1px dotted rgb(172, 12, 124);">Git Bash Here</span>，再在gitbash命令行里面输入node server.js即可。</span><br><br>nodejs建一个后台是非常简单的，只需要<span style="color:#996600;font-style:italic;">引入模块&amp;利用模块创建服务器</span>，现在打开<span style="color:goldenrod;font-weight:bold;">localhost:8080</span>,你就可以看到终端：node——这说明你成功创建了一个能够运行的初始后台。request表示请求，response表示响应，这两个词没有固定要求，大部分人会简写成req和res。客户端请求(req)，服务端响应(res)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const http=require(&apos;http&apos;);</span><br><span class="line">var server=http.createServer(function (req, res)&#123;</span><br><span class="line">  res.write(&quot;abc&quot;);</span><br><span class="line">  res.end();</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure><br>尝试从服务端写入数据,用res.write(),在最后需要添加res.end();否则会报错。上述例子在运行之后，页面会出现abc。<p></p>
<p></p><p style="color:#846e5e;font-weight:bold">querystring</p>querystring是nodejs自带的解析请求字符串的模块，常用的是querystring.parse()用法，将请求字符串解析为json对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const querystring=require(&apos;querystring&apos;);</span><br><span class="line"></span><br><span class="line">var json=querystring.parse(&quot;user=blue&amp;pass=123456&amp;age=18&quot;);</span><br><span class="line">console.log(json);</span><br></pre></td></tr></table></figure><br>上述代码在终端运行会出现如下效果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Object: null prototype] &#123; user: &apos;blue&apos;, pass: &apos;123456&apos;, age: &apos;18&apos; &#125;</span><br></pre></td></tr></table></figure><br>querystring.stringify()与querystring.parse()相对。<br><span style="color:#996600;font-style:italic;">此模块最常用的就是解析get传过来的数据。</span><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">url</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const urllib=require(&apos;url&apos;)</span><br><span class="line">let obj=urllib.parse(&quot;http://www.yes.com/index?a=1&amp;b=coco&quot;,true)</span><br><span class="line">console.log(obj.pathname,obj.query)</span><br></pre></td></tr></table></figure><br>上述文件运行在终端会出现<span style="border-bottom:1px dotted rgb(194, 124, 19);"> /index [Object: null prototype] { a: ‘1’, b: ‘coco’ } </span>url此模块可以解析出路由和传递的参数，并且把传递的参数转化为json格式。<p></p>
<p></p><p style="color:#846e5e;font-weight:bold">fs</p>fs是用来处理文件的模块。常见的文件处理有——读取，重命名，管理上传。<p></p>
<p></p><p style="color:#a96b3e;">读取</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const fs=require(&apos;fs&apos;);</span><br><span class="line"></span><br><span class="line">//readFile(文件名, 回调函数)</span><br><span class="line">fs.readFile(&apos;a.txt&apos;, function (err, data)&#123;</span><br><span class="line">  if(err)&#123;</span><br><span class="line">    console.log(&apos;读取失败&apos;);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    console.log(data.toString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br><span style="color:#996600;font-style:italic;">直接读取会呈现buffer形式的内容，也就是二进制。所以需要将其转换为字符串。</span>上述js文件运行后在终端可以呈现a.txt里的内容<p></p>
<p></p><p style="color:#a96b3e;">内容写入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const fs=require(&apos;fs&apos;);</span><br><span class="line">//writeFile(文件名, 内容, 回调)</span><br><span class="line">fs.writeFile(&quot;a.txt&quot;, &quot;a.txt的内容&quot;, function (err)&#123;</span><br><span class="line">  console.log(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#a96b3e;">删除文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const fs=require(&apos;fs&apos;);</span><br><span class="line">fs.unlink(&quot;b.txt&quot;,(err)=&gt;&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>vscode文件目录处可以看到b.txt已经删除。<br><span style="color:#996600;font-style:italic;">此方法常常用来管理上传文件的修改，源文件要删除以免占用空间。</span><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">自定义模块输出</p><p></p>
<p></p><p style="color:#a96b3e;">模块输出(命名为test.js)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;a:1,b:5&#125;;</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#a96b3e;">模块引入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const all=require(&apos;./test&apos;);/*引入模块，若是当前目录，文件路径需要加上./</span><br><span class="line">如果直接放在文件夹node_modules内，则不需要。*/</span><br><span class="line">console.log(all.a);</span><br></pre></td></tr></table></figure><br>上述结果运行可以在终端看见1。<br><br>此方法常常用于mongodb数据库的连接。自定义一个config，指明存放数据的地址。然后在总接口处引入，连接MongoDB数据库。<br>常用的还有定义一些常用函数模块。如下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//模块test.js</span><br><span class="line">exports.sum=function ()&#123;</span><br><span class="line">  var res=0;</span><br><span class="line"></span><br><span class="line">  for(var i=0;i&lt;arguments.length;i++)&#123;</span><br><span class="line">    res+=arguments[i];//arguments代表传进来的所有参数</span><br><span class="line">  &#125;</span><br><span class="line">  return res;</span><br><span class="line">&#125;;</span><br><span class="line">exports.div=function (a, b)&#123;</span><br><span class="line">  return a/b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//新建一个文件1.js</span><br><span class="line">const test=require(&apos;test&apos;);</span><br><span class="line">console.log(test.sum(10, 5));</span><br></pre></td></tr></table></figure>node 1.js,终端打印出15<p></p>
<p></p><p style="color:#85826c;font-weight:;font-size:20px;height:40px;padding-top: 15px;">Express</p><p></p>
<p></p><p style="color:#a96b3e;">安装 =&gt; 配置 =&gt; 接收请求 =&gt; 响应</p><br><span style="color:rgb(58, 167, 167);font-style:italic;">1.</span><br>利用express创建服务器之后，有三种处理数据的方法:<span style="border-bottom:1px dotted rgb(194, 104, 19);">server.get(‘/‘,function(req,res){});&nbsp;&nbsp;server.post(‘/‘,function(req,res){});&nbsp;&nbsp;server.use(‘/‘,function(req,res){});</span>use方法既可以接收get数据也可以接收post数据<br><span style="color:rgb(58, 167, 167);font-style:italic;">2.</span>在express里，可以用res.send()发送json格式的数据。这一点，res.write()做不到。<br><br>以下示例如何简单验证使用get方式传来的数据<br>首先安装依赖：npm i express express-static<br><br><span style="color:#996600;font-style:italic;">（express-static是中间件，用来加载静态资源</span><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">//放置在根目录文件下的server.js</span><br><span class="line">const express=require(&apos;express&apos;);</span><br><span class="line">const expressStatic=require(&apos;express-static&apos;);</span><br><span class="line"></span><br><span class="line">var server=express();</span><br><span class="line">server.listen(8080);</span><br><span class="line"></span><br><span class="line">server.use(expressStatic(&apos;./www&apos;));//指定静态文件存放路径</span><br><span class="line"></span><br><span class="line">//用户数据</span><br><span class="line">var users=&#123;</span><br><span class="line">  &apos;lily&apos;: &apos;123&apos;,</span><br><span class="line">  &apos;coco&apos;: &apos;abc&apos;</span><br><span class="line">&#125;;</span><br><span class="line">server.get(&apos;/login&apos;, function (req, res)&#123;</span><br><span class="line">  var user=req.query[&apos;user&apos;];</span><br><span class="line">  var pass=req.query[&apos;pass&apos;];</span><br><span class="line"></span><br><span class="line">  if(users[user]==null)&#123;</span><br><span class="line">    res.send(&#123;ok: false, msg: &apos;此用户不存在&apos;&#125;);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    if(users[user]!=pass)&#123;</span><br><span class="line">      res.send(&#123;ok: false, msg: &apos;密码错了&apos;&#125;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      res.send(&#123;ok: true, msg: &apos;成功&apos;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//放置在www文件夹下的form.html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;form action=&quot;http://localhost:8080/login&quot; method=&quot;get&quot;&gt;</span><br><span class="line">      用户：&lt;input type=&quot;text&quot; name=&quot;user&quot; /&gt;</span><br><span class="line">      密码：&lt;input type=&quot;text&quot; name=&quot;pass&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>改用post也可以。只是需要再下载一个模块<span style="border-bottom:1px dotted rgb(194, 104, 19);">body-parser</span>，并且要修改代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const bodyParser=require(&apos;body-parser&apos;);</span><br><span class="line">server.use(bodyParser.urlencoded(&#123;&#125;));</span><br><span class="line">//使用中间件</span><br><span class="line">server.post(&apos;/login&apos;, function (req, res)&#123;//此处可用post，可用use</span><br><span class="line">  console.log(req.body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br>body-parser可以限制传输文件大小和扩展模式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">server.use(bodyParser.urlencoded(&#123;</span><br><span class="line">	extended: false,                 //扩展模式</span><br><span class="line">	limit:    2*1024*1024           //限制2M</span><br><span class="line">  &#125;));</span><br></pre></td></tr></table></figure><br>当我们在www文件夹里新建一个表单网页，并且用post方式传数据的时候，可以在终端看到json数据。例如：{ user: ‘关四鸟’, pass: ‘123’ }<p></p>
<p></p><p style="color:#846e5e;font-weight:bold">session和cookie</p><br>种一个cookie非常简单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server.use(&apos;/test/1.html&apos;,function(req,res)&#123;</span><br><span class="line">	res.cookie(&apos;user&apos;, &apos;gsn&apos;, &#123;path: &apos;/test&apos;, maxAge: 30*24*3600*1000&#125;);</span><br><span class="line">//user:cookie的名称</span><br><span class="line">//gsn:cookie的值</span><br><span class="line">//&#123;path:存放路径，默认值为&apos;/&apos;,maxAge:存放时间，以毫秒计算&#125;</span><br><span class="line">/*&#123;&#125;中还可以填一个重要的选项——signed，但是signed要求cookie-parser模块的安装以及使用*/</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>安装cookie-parser之后具体使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const express=require(&apos;express&apos;)</span><br><span class="line">const cookieParser=require(&apos;cookie-parser&apos;)</span><br><span class="line">let server=express()</span><br><span class="line">//cookie</span><br><span class="line">server.use(cookieParser(&apos;234567890wdd&apos;))//指定密钥方法1</span><br><span class="line">server.use(&apos;/3.html&apos;, function (req, res)&#123;</span><br><span class="line">  req.secret=&apos;234567890wdd&apos;//指定密钥方法2</span><br><span class="line">  res.cookie(&apos;coco&apos;, &apos;123&apos;, &#123;signed: true&#125;)</span><br><span class="line">  res.send(&apos;OK&apos;)</span><br><span class="line">&#125;)</span><br><span class="line">server.listen(8080)</span><br></pre></td></tr></table></figure><br>打开localhost:8080/3.html，右键点击页面-检查-打开Application-打开cookies查看<br>
<table style="font-size:10px;">
	<tr>
		<td>Name</td>
		<td>Value</td>
		<td>Domain</td>
		<td>Path</td>
		<td>Expires/Max-Age</td>
		<td>Size</td>
		<td>HTTP</td>
		<td>Secure</td>
		<td>SameSite</td>
	</tr>
	<tr>
		<td>coco</td>
		<td>s%3A123.zru3dvtug3StnPQZI6mP6ZtuTX3klBUCdo56Xpngfik</td>
		<td>localhost</td>
		<td>/</td>
		<td>1969-12-31T23:59:59.000Z</td>
		<td>55</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<br>想要清除cookie非常简单，代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const express=require(&apos;express&apos;);</span><br><span class="line">const cookieParser=require(&apos;cookie-parser&apos;);</span><br><span class="line">let server=express()</span><br><span class="line"></span><br><span class="line">server.use(cookieParser(&apos;wesdfw4r34tf&apos;))</span><br><span class="line">server.use(&apos;/3.html&apos;, function (req, res)&#123;</span><br><span class="line">  res.clearCookie(&apos;coco&apos;);</span><br><span class="line">  res.send(&apos;ok&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(8080);</span><br></pre></td></tr></table></figure><br>当我们打开浏览器的Application去查看的时候，发现cookie已经清除。<br><br>cookie有很多缺点，比如不够安全，空间有限，只有4k个字节可供使用。基于cookie实现的session就相对来说更加安全一些，并且它是保存数据在服务端的，它的空间无限。<br><br><span style="color:rgb(38, 112, 112);">下载cookie-session(npm i cookie-session)</span><br><br>当我们运行以下代码的时候，可以打开浏览器查看cookies<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">const express=require(&apos;express&apos;);</span><br><span class="line">const cookieParser=require(&apos;cookie-parser&apos;);</span><br><span class="line">const cookieSession=require(&apos;cookie-session&apos;);</span><br><span class="line"></span><br><span class="line">var server=express();</span><br><span class="line"></span><br><span class="line">server.use(cookieParser());</span><br><span class="line">server.use(cookieSession(&#123;</span><br><span class="line">  keys: [&apos;aaa&apos;, &apos;bbb&apos;, &apos;ccc&apos;]</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">server.use(&apos;/&apos;, function (req, res)&#123;</span><br><span class="line">  req.session[&apos;coco&apos;]=2;</span><br><span class="line">  console.log(req.session[&apos;coco&apos;]);</span><br><span class="line">  res.send(&apos;ok&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(1125);</span><br></pre></td></tr></table></figure><br>我们可以看到终端打印出2，且浏览器cookie处显示如下<br>
<table style="font-size:10px;">
	<tr>
		<td>Name</td>
		<td>Value</td>
		<td>Domain</td>
		<td>Path</td>
		<td>Expires/Max-Age</td>
		<td>Size</td>
		<td>HTTP</td>
		<td>Secure</td>
		<td>SameSite</td>
	</tr>
	<tr>
		<td>session</td>
		<td>eyJjb2NvIjoyfQ==</td>
		<td>localhost</td>
		<td>/</td>
		<td>1969-12-31T23:59:59.000Z</td>
		<td>23</td>
		<td>✓</td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>session.sig</td>
		<td>CumeOCBXX8ZIo7l6LM8OdRcCbAs</td>
		<td>localhost</td>
		<td>/</td>
		<td>1969-12-31T23:59:59.000Z</td>
		<td>38</td>
		<td>✓</td>
		<td></td>
		<td></td>
	</tr>
</table>
<br>我们可以利用session制作一个简易的记录浏览次数的小工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">const express=require(&apos;express&apos;);</span><br><span class="line">const cookieParser=require(&apos;cookie-parser&apos;);</span><br><span class="line">const cookieSession=require(&apos;cookie-session&apos;);</span><br><span class="line"></span><br><span class="line">var server=express();</span><br><span class="line"></span><br><span class="line">var arr=[];</span><br><span class="line">for(var i=0;i&lt;100000;i++)&#123;</span><br><span class="line">  arr.push(&apos;sig_&apos;+Math.random());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server.use(cookieParser());</span><br><span class="line">server.use(cookieSession(&#123;</span><br><span class="line">  name: &apos;sess&apos;,</span><br><span class="line">  keys: arr,</span><br><span class="line">  maxAge: 2*3600*1000</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">server.use(&apos;/&apos;, function (req, res)&#123;</span><br><span class="line">  if(req.session[&apos;count&apos;]==null)&#123;</span><br><span class="line">    req.session[&apos;count&apos;]=1;</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    req.session[&apos;count&apos;]++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  console.log(req.session[&apos;count&apos;]);</span><br><span class="line"></span><br><span class="line">  res.send(&apos;ok&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">server.listen(1125);</span><br></pre></td></tr></table></figure><br><span style="color:#996600;font-style:italic;">当我们不断刷新页面的时候，我们会在终端看到1,2,3,4这样的持续输出。</span><p></p>
<p></p><p style="color:#85826c;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">模板引擎及路由</p><br><span style="color:#b4dace;">（渲染出来的页面有一部分跟随程序生成）</span><br>常见模板有两种——jade和ejs，jade属于侵入式，破坏式的模板，已经被淘汰，以下只想详细记录ejs的用法<p></p>
<p></p><p style="color:#846e5e;font-weight:bold">ejs</p><span style="color:rgb(207, 60, 129);font-style:italic;">a.</span><br><span style="color:rgb(160, 143, 151);">数据传递  &lt;%=变量名%&gt;</span><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1.js</span><br><span class="line">const ejs=require(&apos;ejs&apos;)</span><br><span class="line">ejs.renderFile(&apos;./views/1.ejs&apos;, &#123;name: &apos;blue&apos;&#125;, function (err, data)&#123;</span><br><span class="line">  console.log(data)</span><br><span class="line">  //渲染时候传递数据，以json形式放在花括号里</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">1.ejs</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;%=name%&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><br> json数据有多层的时候也是像js引用变量一样引用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">2.js</span><br><span class="line">const ejs=require(&apos;ejs&apos;)</span><br><span class="line">ejs.renderFile(&apos;./views/2.ejs&apos;, &#123;json: &#123;arr: [</span><br><span class="line">  &#123;user: &apos;zhangsan&apos;, pass: &apos;123&apos;&#125;,</span><br><span class="line">  &#123;user: &apos;xiaoming&apos;, pass: &apos;999&apos;&#125;,</span><br><span class="line">]&#125;&#125;, function (err, data)&#123;</span><br><span class="line">  console.log(data);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">2.ejs（内嵌部分）</span><br><span class="line">&lt;%=json.arr[0].user%&gt;</span><br></pre></td></tr></table></figure>终端可以看到输出”zhangsan”<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%=12+5%&gt;</span><br><span class="line">以上在浏览器端会直接输出17</span><br></pre></td></tr></table></figure><br><span style="color:rgb(207, 60, 129);font-style:italic;">b.</span><br><span style="color:rgb(160, 143, 151);">内嵌动态js：示例一个循环</span><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">若4.js里面传递的数据是</span><br><span class="line">&#123;json: &#123;arr: [</span><br><span class="line">  &#123;user: &apos;zhangsan&apos;, pass: &apos;123&apos;&#125;,</span><br><span class="line">  &#123;user: &apos;xiaoming&apos;, pass: &apos;999&apos;&#125;,</span><br><span class="line">]&#125;&#125;</span><br><span class="line"></span><br><span class="line">4.ejs</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;% for(var i=0;i&lt;json.arr.length;i++)&#123; %&gt;</span><br><span class="line">    &lt;div&gt;用户名：&lt;%=json.arr[i].user%&gt; 密码：&lt;%=json.arr[i].pass%&gt;&lt;/div&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">&lt;/body&gt; </span><br></pre></td></tr></table></figure><br>我们会得到如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div&gt;用户名：zhangsan 密码：123&lt;/div&gt;</span><br><span class="line">    &lt;div&gt;用户名：xiaoming 密码：999&lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><br><span style="color:rgb(207, 60, 129);font-style:italic;">c.</span><br><span style="color:rgb(160, 143, 151);">“=”是转义输出，”-“是不转义输出</span><br>当我们要输出标签形式的内容时，如&lt;div&gt;&lt;/div&gt;我们需要不转义输出<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ejs内嵌部分(转义输出)</span><br><span class="line">&lt;%</span><br><span class="line">var str=&quot;&lt;div&gt;&lt;/div&gt;&quot;;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%= str %&gt;</span><br><span class="line"></span><br><span class="line">终端输出</span><br><span class="line">&amp;lt;div&amp;gt;&amp;lt;/div&amp;gt;</span><br><span class="line"></span><br><span class="line">ejs内嵌部分(不转义输出)</span><br><span class="line">&lt;%</span><br><span class="line">var str=&quot;&lt;div&gt;&lt;/div&gt;&quot;;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%- str %&gt;</span><br><span class="line"></span><br><span class="line">终端输出</span><br><span class="line">&lt;div&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><br><span style="color:rgb(207, 60, 129);font-style:italic;">d.</span><br><span style="color:rgb(160, 143, 151);">include关键字的用法</span><br>include意为引入一个文件，可以引入css script等文件，但是注意文件路径一定要正确。<br>我们可以和条件结合使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">6.ejs(关键部分)</span><br><span class="line">&lt;%if(type==&apos;admin&apos;)&#123; %&gt;</span><br><span class="line">    &lt;%include ../style/admin.css%&gt;</span><br><span class="line">    &lt;%&#125;else&#123; %&gt;</span><br><span class="line">    &lt;%include ../style/user.css%&gt;</span><br><span class="line">    &lt;%&#125;%&gt;</span><br><span class="line">    </span><br><span class="line">6.js</span><br><span class="line">const ejs=require(&apos;ejs&apos;);</span><br><span class="line">ejs.renderFile(&apos;./views/6.ejs&apos;, &#123;type: &apos;admin&apos;&#125;, function (err, data)&#123;</span><br><span class="line">  console.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">浏览器端输出</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">    /*admin.css*/</span><br><span class="line">div &#123;width:200px;&#125;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p></p>
<p>用变量传递地址也是完全可以<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">7.js</span><br><span class="line">const ejs=require(&apos;ejs&apos;);</span><br><span class="line">ejs.renderFile(&apos;./views/7.ejs&apos;, &#123;css_path: &apos;../style/admin.css&apos;&#125;, function (err, data)&#123;</span><br><span class="line">  console.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">7.ejs</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;% include css_path %&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p></p><p style="color:#846e5e;font-weight:bold">consolidate</p>express适配所有的引擎会比较麻烦，consolidate提供了一个统一接口。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//引入consolidate模块</span><br><span class="line">const consolidate=require(&apos;consolidate&apos;)</span><br><span class="line">//输出什么东西</span><br><span class="line">server.set(&apos;view engine&apos;, &apos;html&apos;)</span><br><span class="line">//模板文件放在哪儿</span><br><span class="line">server.set(&apos;views&apos;, &apos;./views&apos;)</span><br><span class="line">//哪种模板引擎</span><br><span class="line">server.engine(&apos;html&apos;, consolidate.ejs)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">router</p>express配置了router<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const express=require(&apos;express&apos;);</span><br><span class="line">var server=express();</span><br><span class="line"></span><br><span class="line">// /user/目录下</span><br><span class="line">var routeUser=express.Router();</span><br><span class="line"></span><br><span class="line">routeUser.get(&apos;/1.html&apos;, function (req, res)&#123;   //http://xxx.com/user/1.html</span><br><span class="line">  res.send(&apos;user1&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">routeUser.get(&apos;/2.html&apos;, function (req, res)&#123;   //http://xxx.com/user/2.html</span><br><span class="line">  res.send(&apos;user22222&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.use(&apos;/user&apos;, routeUser);//第一个参数是前缀，第二个参数是路由</span><br></pre></td></tr></table></figure><p style="color:#85826c;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">数据库</p>记得先下载mysql模块&nbsp;&nbsp;&nbsp;<span style="color:#b4dace;">npm i mysql</span><br><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">连接和连接池</p><br>直接创建连接，用createConnection()方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">const mysql=require(&apos;mysql&apos;);</span><br><span class="line"></span><br><span class="line">//1.连接</span><br><span class="line">//createConnection(哪台服务器, 用户名, 密码, 库)</span><br><span class="line">var db=mysql.createConnection(&#123;host: &apos;localhost&apos;, user: &apos;root&apos;, password: &apos;123456&apos;, database: &apos;test&apos;&#125;);</span><br><span class="line"></span><br><span class="line">//2.查询</span><br><span class="line">//query(操作, 回调)</span><br><span class="line">db.query(&quot;SELECT * FROM `user_table`;&quot;, (err, data)=&gt;&#123;</span><br><span class="line">  if(err)&#123;</span><br><span class="line">   console.log(&apos;出错了&apos;, err);</span><br><span class="line">  &#125;</span><br><span class="line">  else&#123;</span><br><span class="line">  	console.log(&apos;成功了&apos;);</span><br><span class="line">	console.log(JSON.stringify(data));</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">	/*JSON.stringify()从一个对象中解析出字符串</span><br><span class="line">	var data=&#123;name:&apos;goatling&apos;&#125;</span><br><span class="line">	JSON.stringify(data)</span><br><span class="line">	结果是：</span><br><span class="line">	&apos;&#123;&quot;name&quot;:&quot;goatling&quot;&#125;&apos;*/</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#a96b3e;">连接池</p><span style="color:rgb(99, 201, 192);font-size:15px;">“ 连接池运作原理在实际应用开发中，特别是在WEB应用系统中，如果JSP、Servlet或EJB使用JDBC直接访问数据库中的数据，每一次数据访问请求都必须经历建立数据库连接、打开数据库、存取数据和关闭数据库连接等步骤，而连接并打开数据库是一件既消耗资源又费时的工作，如果频繁发生这种数据库操作，系统的性能必然会急剧下降，甚至会导致系统崩溃。数据库连接池技术是解决这个问题最常用的方法，在许多应用程序服务器（例如：Weblogic,WebSphere,JBoss）中，基本都提供了这项技术，无需自己编程。 “</span><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const db=mysql.createPool(&#123;host:&apos;localhost&apos;,user:&apos;root&apos;,password:&apos;123456&apos;,database:&apos;blog&apos;&#125;);</span><br><span class="line"></span><br><span class="line">server.get(&apos;/&apos;,(req,res)=&gt;&#123;</span><br><span class="line">	//查询banner</span><br><span class="line">	db.query(&quot;SELECT * FROM banner_table&quot;,(err,data)=&gt;&#123;</span><br><span class="line">		if(err)&#123;</span><br><span class="line">			res.status(500).send(&apos;database error&apos;).end();</span><br><span class="line">			//status是状态码，500代表服务器内部错误</span><br><span class="line">		&#125;</span><br><span class="line">		else&#123;</span><br><span class="line">			res.render(&apos;index.ejs&apos;,&#123;banner:data&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">增删改查(数据库常用语句)</p>增<br><span style="color:rgb(185, 146, 219);font-weight:bold;">INSERT INTO 表名(字段列表) VALUES (值列表)</span><br><span style="color:rgb(131, 116, 145);">INSERT INTO user (`ID`,`user`,`password`) VALUES (0,`wjd`,`123`)<br></span><br>删<br><span style="color:rgb(185, 146, 219);font-weight:bold;">DELETE FROM 表名 WHERE 条件</span><br><span style="color:rgb(131, 116, 145);">DELETE FROM user_tb WHERE `ID`=4</span><br><br>改<br><span style="color:rgb(185, 146, 219);font-weight:bold;">UPDATE 表名 SET field1=new-value1, field2=new-value2 WHERE 条件</span><br><span style="color:rgb(131, 116, 145);">UPDATE user_tb SET `score`=80 WHERE `ID`=4</span><br><br>查<br><span style="color:rgb(185, 146, 219);font-weight:bold;">SELECT 列名,列名 FROM 表名 WHERE 条件</span><br><span style="color:rgb(131, 116, 145);">SELECT name,score FROM user_tb WHERE `score`&gt;60</span><p></p>
<p></p><p style="color:#846e5e;font-weight:bold">子句的运用</p>数据操作常用的有三种语句——条件[where 和 or and]，排序[order]，聚类[group,min,max,avg,count,sum]限制[limit]<br>子句的使用可以组合使用，但是最好按照如下顺序。<br><span style="color:rgb(160, 143, 151);">WHERE(筛选)-&gt;GROUP(合并)-&gt;ORDER(排序)-&gt;LIMIT(限制)</span><br><br><span style="color:#bbb953cc">ORDER</span><br>SELECT name,all_score FROM user_tb WHERE `all_score`&gt;130 ORDER BY math_score ASC,chinese_score DESC<br><span style="border-bottom:1px dotted rgb(194, 104, 19);">从一张名为user_tb的表中找到name，和all_score两列，首先需要符合all_score&gt;130的条件才能被筛选出来，然后按照math_score的大小升序排序，如果价格相同，则按照chinese_score降序排序</span><p></p>
<p><span style="color:#bbb953cc">GROUP</span><br>SELECT COUNT(*) FROM student_table<br><span style="border-bottom:1px dotted rgb(194, 104, 19);">查询结果为8，为记录条数</span><br>SELECT * FROM student_table GROUP BY class<br><span style="border-bottom:1px dotted rgb(194, 104, 19);">结果只剩下class未重复的第一条信息</span><br>SELECT class,COUNT(class) FROM student_table GROUP BY class<br><span style="border-bottom:1px dotted rgb(194, 104, 19);">可以计算出不同班级的总人数</span><br>SELECT class,AVG(all_score) FROM student_table GROUP BY class<br><span style="border-bottom:1px dotted rgb(194, 104, 19);">统计每个班的平均分</span></p>
<p><span style="color:#bbb953cc">LIMIT</span><br>LIMIT子句的这个功能，常见于“网页分页+每页显示最大数”的应用场景。<br>SELECT all_score FROM student_table LIMIT 3,2<br><span style="border-bottom:1px dotted rgb(194, 104, 19);">输出查询结果中第4行开始的共2条内容</span></p>
<p><span style="color:#6dc2e4cc;font-size:19px;font-weight:bold">未完待续 :)</span><br><span style="font-weight:bold;color:orange;">Notice: </span><span style="border-top: 1px dotted #ccffcc;color:orange">NodeJs基础入门实录（下）里会讲解一个超简约后台管理制作，也算实战吧</span></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://gsnwjd.github.io/2019/05/23/用GreenSock.js打造丝滑网页动效/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="gsnwjd王佳典">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="关四鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/23/用GreenSock.js打造丝滑网页动效/" class="post-title-link" itemprop="url">用GreenSock.js打造丝滑网页动效</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-23 08:14:37" itemprop="dateCreated datePublished" datetime="2019-05-23T08:14:37Z">2019-05-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-04-18 07:51:46" itemprop="dateModified" datetime="2020-04-18T07:51:46Z">2020-04-18</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="color:#8c8c8c;border-left:4px solid #8c8c8c;">&nbsp;&nbsp;——本文禁止转载,分享请注明网站出处: ）</span><br><br>我一直都很喜欢动效，但是无奈一直没有找到称手的插件，用css动画实现起来都比较复杂。后来无意中发现了greensock，一口气撸了两个网页首页动效，这两个动效都来自优设微博的推送欣赏。<br>我攒了很多期，最后只剩下九个我比较喜欢的&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://t.cn/E9M9Ulo" target="_blank" rel="noopener">-&gt;每天一遍，防止抑郁</a>.<br>目前我只粗糙地完成了第三个和第七个。</p>
<p><img src="/2019/05/23/用GreenSock.js打造丝滑网页动效/4.gif" alt="动图一"><br><img src="/2019/05/23/用GreenSock.js打造丝滑网页动效/2.gif" alt="动图二"></p>
<p>大家可以去我的GitHub里下载源码&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://github.com/gsnwjd/serry" target="_blank" rel="noopener">-&gt;gsnwjd/serry</a>），我也是第一次使用GitHub（所以拜托如果我哪里犯错了请指出。）<br><br>下面我会把这篇文章分成几个部分，争取每个人看完这篇文章能够有所收获。</p>
<p></p><p style="color:#85826c;font-weight:bold;font-size:20px;">GreenSock.js的核心API介绍</p>（官方文档指路：<a href="https://www.tweenmax.com.cn/api/tweenmax/" target="_blank" rel="noopener">-&gt;TweenMax</a>）<p></p>
<p></p><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">关于补间TweenMax</p><blockquote><p>TweenLite/TweenMax是GreenSock 动画平台中的核心动画工具，可用来构建补间动画(tween)。补间是flash时代的专业词汇，意思是在起始状态和终点状态之间补全中间过程。虽然现在我们使用动画这个词，但是其本质是不变的，仍然要包含四个要素：动画目标（target）、起始状态、终点状态、补间效果。</p>
<footer><strong>——TimelineMax中文手册</strong></footer></blockquote><p style="color:#a96b3e;height:40px;padding-top: 15px;">实例：</p><span style="color:#996600;font-style:italic;">TweenLite是简约版的TweenMax.</span><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TweenLite.fromTo(&apos;div&apos;, 5, &#123;top:300&#125;);</span><br><span class="line">TweenLite.to(&apos;div&apos;, 5, &#123;top:300&#125;);</span><br><span class="line">TweenMax.fromTo(&apos;div&apos;, 5, &#123;top:300&#125;);</span><br><span class="line">TweenMax..to(&apos;div&apos;, 5, &#123;top:300&#125;);</span><br><span class="line">//表示在5秒内把所有的div标签转换到距离父级元素500px的位置</span><br></pre></td></tr></table></figure><br>更常用的是TweenLite.to(),忽略起始状态（因为一般css里我们都写了），记住，300px写做300，要不然会报错。<p></p>
<p></p><p style="color:#a96b3e;height:40px;padding-top: 15px;">延迟</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new TweenMax(&apos;div&apos;, 3, &#123;x: 500,delay: 3&#125;);</span><br></pre></td></tr></table></figure><br>直接加入delay即可，new TweenMax是定义一个补间实例，和TweenMax.to没差别。<p style="color:#a96b3e;height:40px;padding-top: 15px;">速度</p>也是直接加入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new TweenMax(&apos;.box&apos;, 3, &#123;x:500, ease:Power1.easeIn&#125;);</span><br><span class="line">//快速开始，之后越来越慢</span><br><span class="line">new TweenMax(&apos;.box&apos;, 3, &#123;x:500, ease:Power1.easeOut&#125;);</span><br><span class="line">//慢速开始，之后加快，结束前又减速</span><br><span class="line">暂停：</span><br></pre></td></tr></table></figure><br>几种常用速度曲线如下表<br><br>
<table>
<tr>
	<td>曲线种类</td>
	<td>使用</td>
	<td>说明（以出场为例）</td>
</tr>
<tr>
	<td>Power0()</td>
	<td>Power0.easeIn
Power0.easeInOut
Power0.easeOut</td>
	<td>匀速</td>
</tr>
<tr>
	<td>Power1，Power2，Power3，Power4</td>
	<td>Power1.easeIn 等，Power1.easeInOut 等
Power1.easeOut 等</td>
	<td>由快变慢，Power4效果最强烈</td>
</tr>
<tr>
	<td>Sine</td>
	<td>Sine.easeIn
Sine.easeInOut
Sine.easeOut</td>
	<td>正弦效果，由快变慢，比Power1效果弱</td>
</tr>
<tr>
	<td>Circ</td>
	<td>Circ.easeIn
Circ.easeInOut
Circ.easeOut</td>
	<td>突然减速</td>
</tr>
<tr>
	<td>Expo</td>
	<td>Expo.easeIn
Expo.easeInOut
Expo.easeOut</td>
	<td>突然减速，效果更强</td>
</tr>
</table>
<p style="color:#a96b3e;height:40px;padding-top: 15px;">重复</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">new TweenMax(&apos;.box&apos;, 3, &#123;</span><br><span class="line">    x: 500,</span><br><span class="line">    repeat: 3,//动画将进行4次</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p style="color:#a96b3e;">yoyo往返</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new TweenMax(&apos;.box&apos;, 3, &#123;</span><br><span class="line">    x: 500,</span><br><span class="line">    repeat:-1,</span><br><span class="line">    yoyo:true,</span><br><span class="line">    //如果设置yoyo为true，那么重复的动画将往返进行。默认为false.</span><br><span class="line">    //例如当你设置了repeat:2，如果没设置yoyo，那么动画是这样的123-123-123</span><br><span class="line">如果设置了yoyo，动画则是123-321-123。</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><span style="color:#996600;font-style:italic;">repeat设置为-1即表示无限循环，yoyo方法要求循环次数必须大于1次</span><br>这些属性都是直接加入即可。<p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">关于时间轴（本人最爱）</p><blockquote><p>TimelineLite/TimelineMax是GreenSock 动画平台中的动画组织，排序，管理工具，可创建时间轴（timeline）作为动画或其他时间轴的容器，这使得整个动画控制和精确管理时间变得简单。<br>试想一下，如果不使用TimelineLite/TimelineMax创建时间轴，那么构建复杂的动画序列将会非常麻烦，因为你需要用delay为每个动画设置开始时间。</p>
<footer><strong>——TimelineMax中文手册</strong></footer></blockquote><br><p style="color:#a96b3e;height:40px;padding-top: 15px;">基础用法(add和to)</p><span style="font-weight:bold;">add</span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var t1= new TimelineLite();</span><br><span class="line">tl.add( TweenLite.to(element, 1, &#123;left:100&#125;) );//将一个动画添加到时间轴</span><br><span class="line">tl.add( TweenLite.to(element, 1, &#123;top:50&#125;) );//将一个动画添加到时间轴末端，即与前一个动画接续</span><br><span class="line">tl.add( TweenLite.to(element, 1, &#123;opacity:0&#125;) ); //将一个动画添加到时间轴末端，即与前一个动画接续 </span><br><span class="line"></span><br><span class="line">//控制时间轴</span><br><span class="line">tl.pause();//暂停时间轴</span><br><span class="line">t1.play();//播放时间轴</span><br><span class="line">tl.resume();//恢复播放而不改变方向（前进或后退），可选择首先跳到特定时间。</span><br><span class="line">tl.seek(1.5);//不改变状态（播放、暂停、方向）的情况下直接跳转到某个时间点。</span><br><span class="line">tl.reverse();//控制动画反向播放。动画的各种表现都会反转，例如ease。</span><br></pre></td></tr></table></figure><br>这几个控制时间轴的方法都可以在括号里面传递时间参数，以表达从何时开始暂停，播放，暂停，返回。如果参数是-1，则表示动画末端往回1秒位置反向播放。<br><br>add什么都可以添加，比如标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//将一个标签添加至时间轴结束后2秒</span><br><span class="line">tl.add(&quot;myLabel&quot;, &quot;+=2&quot;);</span><br></pre></td></tr></table></figure><br>比如函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//将一个函数添加到1.5秒处</span><br><span class="line">tl.add(func, 1.5); </span><br></pre></td></tr></table></figure><br>比如另一个时间轴<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//将另一个时间轴添加至&quot;myLabel&quot;标签处</span><br><span class="line">tl.add(otherTimeline, &quot;myLabel&quot;); </span><br></pre></td></tr></table></figure><br>比如动画数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//将一个动画数组添加至标签&quot;myLabel&quot;后2秒处</span><br><span class="line">tl.add([tween1, tween2, tween3], &quot;myLabel+=2&quot;); </span><br><span class="line">//将一个动画数组添加至时间轴结尾后2秒处，每个动画都在前一个动画结束0.5秒后开始</span><br><span class="line">tl.add([tween1, tween2, tween3], &quot;+=2&quot;, &quot;sequence&quot;, 0.5);</span><br></pre></td></tr></table></figure><br><span style="font-weight:bold;">to</span><br>添加一个TweenLite.to()动画到时间轴，相当于add(TweenLite.to(…))，以下两行产生相同的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myTimeline.add( TweenLite.to(element, 1, &#123;left:100, opacity:0.5&#125;) );</span><br><span class="line">myTimeline.to(element, 1, &#123;left:100, opacity:0.5&#125;);</span><br></pre></td></tr></table></figure><br>快速链式调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//创建一个时间轴</span><br><span class="line">var tl = new TimelineLite(&#123;onComplete:myFunction&#125;);</span><br><span class="line">//以下是链式调用</span><br><span class="line">tl.to(element, 1, &#123;left:100&#125;)        //添加一个动画</span><br><span class="line">  .to(element, 1, &#123;top:50&#125;, &quot;-=0.25&quot;)    //在时间轴末端前0.25秒（即时间轴0.75秒）处添加动画</span><br><span class="line">  .set(element, &#123;opacity:0&#125;)        //设置动画元素的透明度</span><br><span class="line">  .call(otherFunction)        //执行函数otherFunction()</span><br><span class="line">  .staggerTo([e1, e2, e3], 1.5, &#123;rotation:45&#125;, 0.25); //最后旋转e1, e2, e3，他们的起始间隔是0.25秒</span><br></pre></td></tr></table></figure><br>插入时间轴的几种方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tl.to(element, 1, &#123;left:100&#125;);  //添加至时间轴末尾</span><br><span class="line">tl.to(element, 1, &#123;left:100&#125;, 2);  //添加至2秒处（绝对位置）</span><br><span class="line">tl.to(element, 1, &#123;left:100&#125;, &quot;+=2&quot;);  //添加至时间轴末尾后2秒处（相对位置）</span><br><span class="line">tl.to(element, 1, &#123;left:100&#125;, &quot;myLabel&quot;);  //添加至标记处</span><br><span class="line">tl.to(element, 1, &#123;left:100&#125;, &quot;myLabel+=2&quot;);  //添加至标记后2秒处</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#a96b3e;height:40px;padding-top: 15px;">标签</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tl.to(&quot;#green&quot;, 1, &#123;x:750&#125;).addLabel(&quot;blueSpin&quot;, &quot;+=1&quot;);</span><br><span class="line">//t1时间轴添加一个名为blueSpin的标签，相隔于前一个动画后一秒处。</span><br><span class="line">t1.to(&quot;#blue&quot;, 2, &#123;x:750, rotation:360&#125;, &quot;blueSpin&quot;)</span><br><span class="line">.to(&quot;#orange&quot;, 2, &#123;x:750, rotation:360&#125;, &quot;blueSpin+=0.5&quot;);</span><br><span class="line">//将id为blue的元素从blueSpin标签处开始动画，将id为orange的元素从blueSpin后0.5秒处开始动画</span><br><span class="line">t1.removeLabel(&quot;blueSpin&quot;);//移除标签</span><br></pre></td></tr></table></figure><p></p>
<p></p><p style="color:#a96b3e;height:40px;padding-top: 15px;">打散(staggerTo)</p><br><span style="color:#996600;font-style:italic;">为一组目标设定相同的终点变化属性，但是错开一定的时间，创建成一个间隔均匀的动画序列。</span><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var cata_li=$(&quot;.cata_li&quot;);//获取所有类名为cata_li的元素</span><br><span class="line">var t1 = new TimelineMax();</span><br><span class="line">t1.staggerTo(cata_li,1, &#123;x:60&#125;, 0.5);//第一个类名为.cata_li的元素1s内向右移动60px,0.5s之后第二个类名为.cata_li的元素接着动画，第三个，第四个......形成序列</span><br></pre></td></tr></table></figure><p style="color:#a96b3e;height:30px;padding-top:40px；15px;">ModifiersPlugin 插件实现自循环</p><br><blockquote><p>TweenMax没有包含ModifiersPlugin。<br>ModifiersPlugin 可以为几乎任何属性定义“修饰符（Modifiers）”函数。此修饰符拦截动画通常在每次更新（“tick”）时应用的值，将其作为第一个参数提供给你的函数，并允许你运行自定义逻辑，返回动画应用的新值。<br>你有没有创建过一个旋转木马，并努力使其无缝循环？也许你下载了一些demo或编写了一些代码，这些代码在每个项目到达结尾时将其移回到开头。<br>但使用ModifiersPlugin，你只需用staggerTo()即可获得一个无缝重复的旋转木马！<br>下面的示例将每个框补间到相对x位置”+=500”。单击“Show overflow”按钮，看到每个框在超过500时重置为x：0。</p>
<footer><strong>——TimelineMax中文手册</strong></footer></blockquote><br><span style="font-weight:bold;">走马灯/旋转木马的例子</span><br><a href="https://www.tweenmax.com.cn/ModifiersPlugin/" target="_blank" rel="noopener">-&gt;详情</a><p></p>
<p></p><p style="color:#85826c;font-weight:bold;font-size:20px;height:40px;padding-top: 15px;">途中碰到的一些CSS的问题</p><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">css类的覆盖</p>一开始我以为当如下引用的时候<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;clothes ct&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><br>ct的css如果设定了margin-left:30px，可以覆盖掉clothes里的clothes里的margin:0px auto;<br>那么结果呢？如果要求ct去覆盖clothes,在css文件里面，类ct的css必须要定义在clothes的css之后。这个是我没有想到的，我以为它的类调用是按照使用顺序调用的。<br>不过最好还是不要在类与类之间定义相同属性不同值，这样会造成混乱。<p style="color:#846e5e;font-weight:bold;height:30px;margin-top:30px;">position absolute</p><br>当定义元素position为absolute的时候，在网页中标签排在前面的会先渲染，排在后面的层级更高，可以达到覆盖前面元素的效果。<p></p>
<p></p><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">不常用的scale</p>scale缩放的是整个元素的大小，甚至连里面的子元素也会一起放大缩小，如果我们需要改变父级的大小让其包含的图片慢慢显示的话，最好还是直接改长宽。<p></p>
<p></p><p style="color:#85826c;font-weight:bold;font-size:20px;height:40px;margin-top: 15px;">技巧与思路总结</p><p></p>
<p></p><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">AE中的遮罩概念在网页动效里的简单实现（如动图一）</p><img src="/2019/05/23/用GreenSock.js打造丝滑网页动效/4.gif" alt="动图一"><br>我们将父级元素的位置设置为relative,子元素的位置设置为absolute<br><span style="color:#996600;font-style:italic;">父元素，子元素，遮罩的宽度，长度最好设置成一样的值，遮罩可以大一点点。父元素的overflow设置为hidden</span><br>子元素的遮罩位置也设置为abosolute，然后left:整个父元素的宽度.<br>我们直接用如下的例子<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var tl = new TimelineMax();</span><br><span class="line">tl.add( TweenLite.to(&apos;.el_alpha&apos;, 1, &#123;left:0&#125;) );</span><br></pre></td></tr></table></figure><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">代码复用</p>我们也可以进行函数传参，达到代码复用<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function alpha(el)&#123;</span><br><span class="line">var tl = new TimelineMax();</span><br><span class="line">tl.add( TweenLite.to(el, 1, &#123;left:0&#125;) );</span><br><span class="line">&#125;</span><br><span class="line">alpha(&apos;.el_alpha&apos;);</span><br><span class="line">alpha(&apos;.el_cut_alpha&apos;);</span><br><span class="line">//实现动图一中右边两个块的动画，当然其中的元素还需要更精确的位置设定，大家可以下载我的源码去看。</span><br></pre></td></tr></table></figure><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">更自然的遮罩</p>大家发现没有，这个动图它的背景颜色，是会随着图片的改变而改变的，我们定义一个类为bg1，让所有定义的遮罩层以及整体容器的class后面都加入这个类，我们定义类一个变色动画，那么整体的遮罩就可以更自然。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var t3=new TimelineMax(&#123;repeat:1,repeatdelay:1,yoyo:true&#125;);</span><br><span class="line">t3.add(TweenLite.to(&apos;.bg1&apos;,2.6,&#123;backgroundColor:&apos;#e6efdc&apos;&#125;));</span><br></pre></td></tr></table></figure><p style="color:#846e5e;font-weight:bold;height:40px;padding-top: 15px;">staggerTo的几种实现</p>1.直接用类追加在需要动画的元素的class里，给类加动画。<br>2.用js原生的split方法去切割字符串。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">	&lt;style&gt;</span><br><span class="line">.sp&#123;</span><br><span class="line">	float:left;</span><br><span class="line">	list-style: none;</span><br><span class="line">	opacity:0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">	&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;cyc&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;split&quot;&gt;这个方法很不好用&lt;/div&gt;</span><br><span class="line">&lt;script src=&quot;../js/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;../js/TimelineMax.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;../js/TweenMax.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var sp=$(&apos;.split&apos;).text();//获取文本</span><br><span class="line">var text_all=&quot;&quot;;</span><br><span class="line">var text=&quot;&quot;;</span><br><span class="line">sp=sp.split(&quot;&quot;);//开始切割字符串</span><br><span class="line">sp=sp.reverse();//倒置字符串</span><br><span class="line"></span><br><span class="line">for(var i=0;i&lt;sp.length;i++)&#123;</span><br><span class="line">	text=&quot;&lt;li class=&apos;sp&apos;&gt;&quot;+sp[i]+&quot;&lt;/li&gt;&quot;;</span><br><span class="line">	text_all=text+text_all;</span><br><span class="line">&#125;</span><br><span class="line">text=&quot;&lt;ul&gt;&quot;+text_all+&quot;&lt;/ul&gt;&quot;;//生成序列</span><br><span class="line">$(&quot;.split&quot;).html(text);//放入原处</span><br><span class="line"></span><br><span class="line">var t1=new TimelineMax();</span><br><span class="line">var sp=$(&apos;.sp&apos;);</span><br><span class="line">t1.staggerTo(sp,0.3, &#123;opacity:1&#125;, 0.5);//开始动画</span><br><span class="line">&lt;/script&gt;	</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><br>3.用GreenSock.js自带的插件<a href="https://www.tweenmax.com.cn/SplitText/" style="color:#5d5d51;" target="_blank" rel="noopener">-&gt;SplitText</a><br>(不过这个插件是收费的)<br><br><span style="font-weight:bold;color:orange;">Notice: </span><span style="border-top: 1px dotted #ccffcc;color:orange">以上大部分demo都来自官方文档，我改了一些注释便于理解，其实GreenSock.js还有很多很多的方法，但是其实对于我来说，上面的这些就已经够用了。祝享用愉快:)</span><p></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">gsnwjd王佳典</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">gsnwjd王佳典</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.1"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
